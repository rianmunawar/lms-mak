<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\102\x41\123\x45\x50\101\124\x48") or exit("\x4e\x6f\40\144\151\162\x65\x63\164\40\163\x63\162\x69\x70\x74\x20\x61\143\143\x65\x73\x73\40\x61\154\154\157\167\145\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto jQM6D; z5yxf: $this->lang->load("\151\157\x6e\x5f\141\x75\x74\150"); goto z23dt; HaQbX: $this->message_end_delimiter = $this->config->item("\x6d\145\163\163\141\x67\x65\137\145\x6e\x64\137\144\x65\154\151\155\151\164\x65\x72", "\151\x6f\156\137\x61\165\x74\150"); goto D_7IG; CxeyF: $this->hash_method = $this->config->item("\150\141\163\x68\x5f\155\x65\164\x68\x6f\x64", "\x69\157\x6e\137\x61\x75\164\x68"); goto grIo9; KOeB5: $this->join = $this->config->item("\x6a\x6f\x69\x6e", "\x69\157\x6e\x5f\x61\x75\x74\150"); goto CxeyF; zSp0R: Y35x1: goto RbmRN; msUDF: $CI =& get_instance(); goto SEYPT; k3efk: $error_suffix = $form_validation_class->getProperty("\x5f\x65\162\x72\x6f\x72\137\163\165\x66\x66\151\x78"); goto B421Z; CV2cr: $this->error_end_delimiter = $this->config->item("\145\162\x72\x6f\x72\x5f\x65\x6e\144\137\x64\145\154\151\155\x69\x74\x65\x72", "\x69\x6f\156\137\141\x75\164\150"); goto yzDAI; CDQzJ: $form_validation_class = new ReflectionClass("\103\x49\137\106\x6f\162\x6d\137\x76\141\x6c\151\x64\141\x74\151\x6f\156"); goto FOx1Z; u149J: goto Y35x1; goto n57lK; hSZlB: $this->message_start_delimiter = $this->config->item("\x6d\145\163\x73\141\147\145\137\x73\164\x61\162\x74\137\x64\145\154\x69\x6d\151\164\x65\x72", "\151\x6f\x6e\x5f\141\x75\164\150"); goto HaQbX; sBQH3: $this->message_end_delimiter = $this->error_end_delimiter; goto EaE3i; EaE3i: sJIJP: goto Vq7Oq; oEANH: $this->load->library("\146\x6f\162\155\x5f\x76\141\x6c\x69\144\141\x74\x69\157\156"); goto CDQzJ; n57lK: T9Ikq: goto msUDF; R5ICN: if (empty($group_name)) { goto T9Ikq; } goto o9uMp; nNfZa: $this->message_start_delimiter = $this->error_start_delimiter; goto k3efk; Ix1mp: $this->identity_column = $this->config->item("\151\144\145\156\164\x69\x74\x79", "\x69\x6f\156\x5f\141\x75\x74\x68"); goto KOeB5; RbmRN: $this->tables = $this->config->item("\x74\x61\142\x6c\145\x73", "\151\157\x6e\137\141\165\164\150"); goto Ix1mp; SEYPT: $this->db = $CI->db; goto zSp0R; vs7N2: $this->load->helper("\143\157\157\x6b\151\x65"); goto DUQCa; z23dt: $group_name = $this->config->item("\144\141\x74\x61\142\x61\x73\145\137\147\162\157\165\160\x5f\x6e\x61\x6d\145", "\x69\x6f\156\x5f\141\x75\164\x68"); goto R5ICN; FOx1Z: $error_prefix = $form_validation_class->getProperty("\137\145\162\x72\157\x72\137\x70\162\x65\x66\151\x78"); goto W2Kf7; jQM6D: $this->config->load("\151\157\x6e\137\x61\165\164\x68", TRUE); goto vs7N2; yzDAI: goto sJIJP; goto vbPAS; yG1Ma: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto nNfZa; QKjmX: if ($delimiters_source === "\x66\x6f\x72\155\137\x76\141\x6c\151\144\141\164\x69\x6f\x6e") { goto A_Mjq; } goto hSZlB; vbPAS: A_Mjq: goto oEANH; Vq7Oq: $this->_ion_hooks = new stdClass(); goto CEX6X; grIo9: $this->messages = []; goto ki9m7; DUQCa: $this->load->helper("\x64\x61\164\145"); goto z5yxf; B421Z: $error_suffix->setAccessible(TRUE); goto pP9Ys; ki9m7: $this->errors = []; goto XyBVg; XyBVg: $delimiters_source = $this->config->item("\x64\x65\x6c\x69\155\x69\x74\145\x72\163\137\163\157\x75\x72\x63\x65", "\151\x6f\x6e\137\x61\x75\164\150"); goto QKjmX; W2Kf7: $error_prefix->setAccessible(TRUE); goto yG1Ma; o9uMp: $this->db = $this->load->database($group_name, TRUE, TRUE); goto u149J; CEX6X: $this->trigger_events("\155\157\x64\145\154\137\143\x6f\x6e\x73\x74\x72\165\143\x74\157\162"); goto tzqx4; pP9Ys: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto sBQH3; D_7IG: $this->error_start_delimiter = $this->config->item("\x65\162\x72\157\162\137\163\164\x61\162\x74\x5f\144\145\154\151\x6d\151\x74\x65\x72", "\151\x6f\156\x5f\x61\x75\x74\150"); goto CV2cr; tzqx4: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto pMkzZ; Ooaoz: $algo = $this->_get_hash_algo(); goto A3Oca; grVWb: if (!($algo !== FALSE && $params !== FALSE)) { goto ax_x2; } goto ZBVzy; ZBVzy: return password_hash($password, $algo, $params); goto vsrWz; pMkzZ: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto gHk2O; } goto eMuRl; vsrWz: ax_x2: goto YuuRr; YuuRr: return FALSE; goto xE_kV; gnvKp: gHk2O: goto Ooaoz; eMuRl: return FALSE; goto gnvKp; A3Oca: $params = $this->_get_hash_parameters($identity); goto grVWb; xE_kV: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto zETVv; BM20q: OMWf5: goto t4859; kgCao: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto LIbzO; t4859: if (strpos($hash_password_db, "\44") === 0) { goto PHBmt; } goto kgCao; zETVv: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto OMWf5; } goto D8jLE; eyiGJ: return password_verify($password, $hash_password_db); goto JDe23; LIbzO: goto PRjzP; goto pBqCx; pBqCx: PHBmt: goto eyiGJ; JDe23: PRjzP: goto m50M_; D8jLE: return FALSE; goto BM20q; m50M_: } public function rehash_password_if_needed($hash, $identity, $password) { goto IR9Ww; zll9m: $this->trigger_events(["\x72\x65\x68\141\163\x68\x5f\160\141\163\163\x77\x6f\162\144", "\162\x65\x68\x61\x73\x68\137\x70\x61\x73\x73\167\157\162\x64\x5f\163\165\143\x63\145\163\x73\146\x75\x6c"]); goto mtSJJ; yMqxz: $this->trigger_events(["\x72\x65\x68\x61\163\x68\x5f\160\141\163\163\167\x6f\x72\144", "\x72\145\x68\141\163\x68\x5f\160\141\x73\x73\167\157\x72\x64\x5f\165\156\163\x75\x63\143\x65\x73\x73\x66\165\x6c"]); goto fuWAQ; w77DZ: YFVDy: goto Vv2wN; IR9Ww: $algo = $this->_get_hash_algo(); goto x95IA; qp92a: if ($this->_set_password_db($identity, $password)) { goto b1YUR; } goto yMqxz; x95IA: $params = $this->_get_hash_parameters($identity); goto Iuw5l; nvNtL: bOX0N: goto w77DZ; Nj3SB: b1YUR: goto zll9m; mtSJJ: gkNfQ: goto nvNtL; fuWAQ: goto gkNfQ; goto Nj3SB; Iuw5l: if (!($algo !== FALSE && $params !== FALSE)) { goto YFVDy; } goto QxB9B; QxB9B: if (!password_needs_rehash($hash, $algo, $params)) { goto bOX0N; } goto qp92a; Vv2wN: } public function get_user_by_activation_code($user_code) { goto VaHKy; g3fmQ: if (!$this->verify_password($token->validator, $user->activation_code)) { goto vhBs4; } goto Lh1pd; aEc5Q: vhBs4: goto X3tpR; FGX01: if (!$user) { goto yNGHL; } goto g3fmQ; d8nc7: return FALSE; goto aOith; Lh1pd: return $user; goto aEc5Q; VaHKy: $token = $this->_retrieve_selector_validator_couple($user_code); goto ND1mk; ND1mk: $user = $this->where("\x61\143\x74\x69\x76\x61\x74\151\x6f\156\x5f\x73\145\154\x65\143\164\x6f\162", $token->selector)->users()->row(); goto FGX01; X3tpR: yNGHL: goto d8nc7; aOith: } public function activate($id, $code = FALSE) { goto mcNsi; PiUQQ: return FALSE; goto gc9R4; NXPPY: $this->trigger_events(["\160\x6f\x73\x74\x5f\x61\x63\164\151\x76\141\164\145", "\160\x6f\x73\x74\x5f\141\143\164\x69\x76\141\164\x65\137\165\x6e\x73\x75\x63\143\145\x73\163\146\165\x6c"]); goto hrAYf; oTjc9: $data = ["\x61\143\x74\151\166\141\x74\151\x6f\x6e\x5f\163\x65\154\x65\143\x74\157\162" => NULL, "\141\143\164\x69\x76\x61\164\x69\157\x6e\137\x63\157\144\x65" => NULL, "\141\x63\164\x69\x76\x65" => 1]; goto oR9dk; AyFg8: if (!($this->db->affected_rows() === 1)) { goto hVUQ3; } goto jjzfY; mcNsi: $this->trigger_events("\x70\x72\x65\137\x61\x63\x74\151\166\x61\164\145"); goto Zvtas; m13q4: if (!($code === FALSE || $user && $user->id === $id)) { goto pQEsy; } goto oTjc9; Zvtas: if (!($code !== FALSE)) { goto LSU64; } goto a1wdw; OxoXb: LSU64: goto m13q4; Pmtyb: $this->set_message("\x61\x63\x74\151\x76\x61\164\145\x5f\x73\x75\x63\143\x65\163\163\146\x75\x6c"); goto TLxOQ; oR9dk: $this->trigger_events("\145\170\164\x72\x61\x5f\x77\150\x65\x72\x65"); goto FEwyi; a1wdw: $user = $this->get_user_by_activation_code($code); goto OxoXb; DqJi0: pQEsy: goto NXPPY; TLxOQ: return TRUE; goto NI2YF; hrAYf: $this->set_error("\141\143\x74\x69\x76\141\x74\x65\137\x75\156\163\165\x63\143\x65\x73\163\x66\x75\x6c"); goto PiUQQ; FEwyi: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, ["\x69\x64" => $id]); goto AyFg8; NI2YF: hVUQ3: goto DqJi0; jjzfY: $this->trigger_events(["\160\157\163\164\137\x61\x63\x74\x69\166\141\x74\145", "\x70\157\163\164\137\141\143\x74\x69\166\141\x74\145\x5f\x73\x75\143\x63\x65\x73\x73\146\x75\x6c"]); goto Pmtyb; gc9R4: } public function deactivate($id = NULL) { goto LFQVC; QiiVG: $this->trigger_events("\145\170\164\x72\x61\x5f\x77\150\x65\162\145"); goto fownK; TwKYW: $this->set_error("\x64\145\x61\x63\x74\151\166\x61\x74\x65\x5f\143\x75\162\162\x65\x6e\164\137\165\163\x65\x72\x5f\165\156\x73\x75\x63\x63\145\x73\163\x66\x75\154"); goto vvHYJ; Oc91M: HjfhU: goto sf0kl; DTApV: return FALSE; goto UrjKJ; Yp4Vj: if ($return) { goto HjfhU; } goto uqvRa; zoXIA: return $return; goto s9_KD; vvHYJ: return FALSE; goto zQ08f; RLbfe: $token = $this->_generate_selector_validator_couple(20, 40); goto dLZex; U2Fh3: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto UA2mE; } goto TwKYW; N1EO_: $this->set_error("\144\x65\x61\x63\x74\x69\x76\141\x74\x65\137\165\x6e\163\x75\143\x63\145\x73\163\146\x75\154"); goto DTApV; zQ08f: UA2mE: goto AcqoP; eszm4: DVS_2: goto zoXIA; uqvRa: $this->set_error("\x64\145\x61\143\x74\151\166\141\164\x65\x5f\x75\156\x73\165\x63\143\x65\163\163\146\165\x6c"); goto qzea7; AcqoP: goto ZOkWZ; goto XdNMN; fownK: $this->db->update($this->tables["\x75\163\145\162\x73"], $data, ["\x69\x64" => $id]); goto vB2Zp; caXzR: if (!isset($id)) { goto wppH8; } goto U2Fh3; sf0kl: $this->set_message("\144\x65\x61\x63\x74\x69\x76\x61\164\x65\137\x73\x75\x63\x63\145\163\x73\x66\x75\x6c"); goto eszm4; vB2Zp: $return = $this->db->affected_rows() == 1; goto Yp4Vj; XdNMN: wppH8: goto N1EO_; dLZex: $this->activation_code = $token->user_code; goto QStOf; UrjKJ: ZOkWZ: goto RLbfe; qzea7: goto DVS_2; goto Oc91M; LFQVC: $this->trigger_events("\x64\145\141\x63\x74\x69\166\x61\164\x65"); goto caXzR; QStOf: $data = ["\x61\x63\164\x69\x76\x61\164\151\x6f\156\x5f\x73\145\x6c\145\x63\x74\x6f\x72" => $token->selector, "\x61\x63\x74\151\166\141\x74\x69\x6f\x6e\x5f\x63\x6f\144\145" => $token->validator_hashed, "\x61\x63\164\151\x76\x65" => 0]; goto QiiVG; s9_KD: } public function clear_forgotten_password_code($identity) { goto xTT7a; HDNw_: mYxKC: goto VbbPF; Kez7L: $this->db->update($this->tables["\x75\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto fHrIE; xTT7a: if (!empty($identity)) { goto mYxKC; } goto WzCvP; VbbPF: $data = ["\x66\157\x72\147\x6f\x74\x74\145\156\x5f\160\141\x73\163\x77\x6f\x72\144\137\163\x65\154\x65\x63\164\x6f\162" => NULL, "\x66\x6f\162\x67\157\164\164\x65\x6e\137\160\141\x73\163\x77\157\162\144\137\x63\157\x64\145" => NULL, "\146\x6f\162\147\157\x74\164\145\x6e\137\x70\141\163\163\167\157\x72\x64\137\x74\151\x6d\145" => NULL]; goto Kez7L; WzCvP: return FALSE; goto HDNw_; fHrIE: return TRUE; goto Qsh7N; Qsh7N: } public function clear_remember_code($identity) { goto qfPa6; NWDkS: $this->db->update($this->tables["\165\x73\145\162\163"], $data, [$this->identity_column => $identity]); goto KdbC7; KdbC7: return TRUE; goto TNyoj; h29oL: $data = ["\162\145\155\x65\155\x62\145\x72\137\x73\145\x6c\145\143\x74\157\162" => NULL, "\x72\x65\x6d\x65\x6d\x62\145\x72\x5f\143\157\x64\145" => NULL]; goto NWDkS; gJD73: return FALSE; goto DVhSN; DVhSN: klyEA: goto h29oL; qfPa6: if (!empty($identity)) { goto klyEA; } goto gJD73; TNyoj: } public function reset_password($identity, $new) { goto drEqr; pHrER: $return = $this->_set_password_db($identity, $new); goto CJ95O; QEuTa: uO98l: goto WLfVQ; n4J6r: if ($this->identity_check($identity)) { goto a1ZK0; } goto ZSgC5; Q0mX4: $this->set_error("\x70\141\x73\163\x77\x6f\162\x64\x5f\x63\x68\x61\x6e\x67\x65\137\165\156\x73\x75\x63\x63\x65\163\163\x66\x75\154"); goto R1MyG; lfePy: return FALSE; goto S6KGd; CJ95O: if ($return) { goto uO98l; } goto tKuvl; jXEnv: vEEWU: goto ZILK6; drEqr: $this->trigger_events("\160\x72\145\137\x63\x68\141\x6e\147\x65\137\160\x61\x73\x73\x77\157\x72\x64"); goto n4J6r; WLfVQ: $this->trigger_events(["\x70\x6f\163\x74\x5f\143\x68\141\156\147\x65\137\x70\x61\163\163\x77\x6f\162\144", "\x70\x6f\x73\x74\x5f\x63\150\x61\x6e\x67\145\137\160\141\x73\163\167\157\x72\144\137\163\165\143\143\x65\x73\163\x66\165\x6c"]); goto I3czD; R1MyG: goto vEEWU; goto QEuTa; ZILK6: return $return; goto nSB0b; tKuvl: $this->trigger_events(["\160\x6f\x73\x74\137\143\150\x61\156\x67\145\137\x70\141\163\163\x77\157\x72\x64", "\160\157\x73\x74\137\143\x68\x61\156\147\x65\137\x70\x61\163\x73\x77\x6f\x72\144\x5f\x75\x6e\163\x75\x63\143\x65\x73\x73\146\x75\154"]); goto Q0mX4; S6KGd: a1ZK0: goto pHrER; ZSgC5: $this->trigger_events(["\x70\x6f\x73\x74\x5f\143\x68\141\x6e\147\x65\x5f\x70\141\x73\163\167\x6f\x72\x64", "\x70\x6f\x73\164\x5f\143\150\x61\x6e\147\x65\137\x70\x61\163\163\x77\157\162\x64\x5f\165\x6e\x73\x75\x63\143\145\x73\x73\x66\165\x6c"]); goto lfePy; I3czD: $this->set_message("\160\x61\x73\x73\x77\x6f\x72\x64\x5f\143\x68\x61\x6e\x67\145\137\163\165\143\x63\x65\x73\163\146\165\x6c"); goto jXEnv; nSB0b: } public function change_password($identity, $old, $new) { goto n8r3X; CKxkG: if ($result) { goto XiWrt; } goto Lgook; FnMEo: $this->trigger_events(["\160\x6f\x73\164\137\143\150\x61\156\x67\x65\x5f\160\141\x73\163\x77\x6f\162\144", "\160\x6f\163\164\137\x63\x68\141\x6e\x67\145\137\160\141\x73\x73\167\x6f\162\x64\137\x73\x75\x63\143\x65\x73\x73\x66\x75\x6c"]); goto L1XoG; E5Zcd: $query = $this->db->select("\151\x64\x2c\x20\x70\141\163\163\x77\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\151\x64", "\144\145\163\x63")->get($this->tables["\x75\x73\x65\162\163"]); goto L9sVt; OQf4Z: goto BJiI1; goto iqldP; jN0sJ: $this->set_error("\160\141\163\x73\167\x6f\x72\144\x5f\143\150\x61\x6e\x67\145\x5f\x75\x6e\163\165\143\x63\x65\x73\163\146\x75\x6c"); goto gnN0z; L1XoG: $this->set_message("\x70\x61\x73\x73\167\157\162\144\137\143\x68\141\156\147\x65\x5f\163\165\x63\x63\x65\163\x73\x66\x75\154"); goto XCU_g; H0v_m: YAwMg: goto EBW7_; n8r3X: $this->trigger_events("\x70\x72\145\x5f\x63\x68\x61\x6e\x67\145\137\x70\141\x73\x73\167\x6f\162\144"); goto SLtuq; shXCu: return FALSE; goto H0v_m; Lgook: $this->trigger_events(["\160\x6f\163\x74\x5f\143\x68\x61\156\x67\x65\x5f\x70\141\x73\163\x77\x6f\x72\x64", "\x70\x6f\x73\164\137\x63\150\141\156\147\x65\137\160\141\x73\x73\167\x6f\162\144\x5f\165\156\x73\x75\143\x63\x65\x73\x73\x66\165\x6c"]); goto IZ8ab; gnN0z: return FALSE; goto CtIyS; NjBAp: $result = $this->_set_password_db($identity, $new); goto CKxkG; qJZGy: return $result; goto Vm6Rt; EBW7_: $user = $query->row(); goto qq0hz; iqldP: XiWrt: goto FnMEo; IZ8ab: $this->set_error("\x70\x61\163\x73\x77\157\162\x64\x5f\x63\150\141\x6e\147\145\x5f\165\x6e\163\165\143\143\145\163\x73\146\165\154"); goto OQf4Z; SLtuq: $this->trigger_events("\145\x78\164\162\141\x5f\x77\150\x65\162\145"); goto E5Zcd; XCU_g: BJiI1: goto qJZGy; Vm6Rt: qS1NL: goto jN0sJ; EFFmP: $this->set_error("\x70\141\x73\163\x77\x6f\x72\x64\137\143\150\141\156\x67\x65\x5f\x75\156\163\x75\143\x63\145\163\163\x66\x75\154"); goto shXCu; L9sVt: if (!($query->num_rows() !== 1)) { goto YAwMg; } goto f7YSu; f7YSu: $this->trigger_events(["\160\x6f\x73\x74\x5f\x63\150\x61\x6e\147\x65\137\x70\141\163\x73\167\157\162\144", "\x70\157\x73\x74\x5f\143\x68\141\156\147\x65\x5f\160\141\163\163\167\157\162\144\137\x75\x6e\163\x75\x63\143\x65\163\163\x66\165\x6c"]); goto EFFmP; qq0hz: if (!$this->verify_password($old, $user->password, $identity)) { goto qS1NL; } goto NjBAp; CtIyS: } public function username_check($username = '') { goto iOO5R; iOO5R: $this->trigger_events("\165\x73\145\162\x6e\x61\x6d\145\x5f\143\x68\145\143\x6b"); goto kc1Pb; c3KrX: $this->trigger_events("\x65\x78\x74\162\x61\137\167\x68\145\x72\x65"); goto WKOpT; kc1Pb: if (!empty($username)) { goto GGr8g; } goto L5GA_; WKOpT: return $this->db->where("\165\x73\145\x72\x6e\x61\x6d\145", $username)->limit(1)->count_all_results($this->tables["\165\163\145\x72\163"]) > 0; goto iRkap; L5GA_: return FALSE; goto egzmg; egzmg: GGr8g: goto c3KrX; iRkap: } public function email_check($email = '') { goto Itv1r; QXrip: return $this->db->where("\145\155\x61\151\x6c", $email)->limit(1)->count_all_results($this->tables["\165\x73\x65\x72\x73"]) > 0; goto hsS5H; wM_3Y: return FALSE; goto w254z; mB5oz: if (!empty($email)) { goto YgXSr; } goto wM_3Y; w254z: YgXSr: goto MZVPR; Itv1r: $this->trigger_events("\145\x6d\x61\151\x6c\x5f\143\x68\x65\143\153"); goto mB5oz; MZVPR: $this->trigger_events("\145\x78\164\162\141\137\167\150\x65\162\x65"); goto QXrip; hsS5H: } public function identity_check($identity = '') { goto m7Vb8; ChkP4: return FALSE; goto EUi3C; gGJ6T: if (!empty($identity)) { goto awXES; } goto ChkP4; EUi3C: awXES: goto D0MhJ; m7Vb8: $this->trigger_events("\x69\x64\145\156\164\151\164\171\137\143\150\145\143\x6b"); goto gGJ6T; D0MhJ: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\165\x73\145\x72\x73"]) > 0; goto pbHPV; pbHPV: } public function get_user_id_from_identity($identity = '') { goto R_jh9; YOLJ3: return FALSE; goto QwzQi; scT5V: $user = $query->row(); goto f19T7; R_jh9: if (!empty($identity)) { goto RJCHA; } goto YOLJ3; O1jbQ: if (!($query->num_rows() !== 1)) { goto ymo9L; } goto miRub; QwzQi: RJCHA: goto f2nDp; f19T7: return $user->id; goto ytul5; f2nDp: $query = $this->db->select("\x69\x64")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\x73\145\162\x73"]); goto O1jbQ; GboTX: ymo9L: goto scT5V; miRub: return FALSE; goto GboTX; ytul5: } public function forgotten_password($identity) { goto zaLVK; ikg51: $this->trigger_events(["\x70\x6f\163\x74\x5f\x66\x6f\162\147\x6f\164\x74\145\x6e\x5f\160\141\x73\163\x77\x6f\162\x64", "\x70\157\163\x74\137\x66\157\162\x67\157\x74\x74\145\156\137\160\x61\x73\x73\x77\x6f\x72\x64\x5f\163\165\143\x63\145\x73\163\x66\x75\x6c"]); goto e9fsa; YL_2I: if ($this->db->affected_rows() === 1) { goto FNrEs; } goto VGdjn; vFTwF: return FALSE; goto Aiemp; w2hTI: FNrEs: goto ikg51; BA8Eg: kDaMl: goto p6kFU; N2aeX: $update = ["\146\x6f\162\147\157\x74\x74\x65\156\x5f\160\141\163\x73\167\157\x72\x64\137\163\145\x6c\x65\143\164\157\x72" => $token->selector, "\x66\157\x72\147\x6f\x74\164\145\156\137\160\141\163\x73\167\157\x72\x64\x5f\143\x6f\x64\x65" => $token->validator_hashed, "\146\x6f\162\147\x6f\x74\x74\145\156\137\x70\x61\163\x73\x77\157\x72\144\137\164\x69\x6d\x65" => time()]; goto zSc0N; p6kFU: $token = $this->_generate_selector_validator_couple(20, 80); goto N2aeX; e9fsa: return $token->user_code; goto Tz_m2; VGdjn: $this->trigger_events(["\160\x6f\163\164\x5f\146\x6f\162\147\157\x74\x74\145\156\x5f\x70\x61\x73\x73\x77\x6f\x72\x64", "\160\157\163\164\x5f\146\x6f\162\147\x6f\x74\164\x65\156\x5f\160\141\x73\163\x77\157\x72\x64\x5f\165\x6e\163\x75\x63\x63\x65\x73\x73\x66\x75\154"]); goto vFTwF; KB3dd: $this->db->update($this->tables["\165\163\145\162\x73"], $update, [$this->identity_column => $identity]); goto YL_2I; zaLVK: if (!empty($identity)) { goto kDaMl; } goto KMpc0; I9wdy: return FALSE; goto BA8Eg; Aiemp: goto t1haj; goto w2hTI; zSc0N: $this->trigger_events("\145\x78\164\x72\141\x5f\167\150\145\162\145"); goto KB3dd; KMpc0: $this->trigger_events(["\x70\x6f\x73\164\x5f\x66\x6f\x72\147\x6f\x74\164\x65\x6e\137\x70\x61\x73\x73\x77\157\x72\x64", "\160\157\x73\x74\x5f\146\157\x72\x67\x6f\164\x74\x65\x6e\x5f\160\x61\163\x73\x77\x6f\x72\x64\137\x75\x6e\163\x75\143\143\145\x73\163\146\x75\x6c"]); goto I9wdy; Tz_m2: t1haj: goto RCDra; RCDra: } public function get_user_by_forgotten_password_code($user_code) { goto oafQM; vgoGR: return FALSE; goto iELtY; VufYY: if (!$user) { goto wywBe; } goto dgNlR; kc5h3: wywBe: goto vgoGR; OvvRU: $user = $this->where("\146\157\x72\147\x6f\x74\164\145\156\x5f\x70\x61\x73\163\167\157\x72\144\x5f\x73\x65\154\145\x63\164\157\162", $token->selector)->users()->row(); goto VufYY; dgNlR: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto ZKL7l; } goto Db2Hy; oafQM: $token = $this->_retrieve_selector_validator_couple($user_code); goto OvvRU; Db2Hy: return $user; goto Q34Uv; Q34Uv: ZKL7l: goto kc5h3; iELtY: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto ZQQoP; Uip0c: RPgbd: goto SdrIj; cBLLc: TzCLw: goto eiPRM; YEeMI: $data = [$this->identity_column => $identity, "\x75\163\145\x72\156\x61\155\145" => $identity, "\x70\x61\163\163\x77\x6f\x72\144" => $password, "\x65\155\x61\x69\x6c" => $email, "\x69\160\x5f\141\144\x64\x72\145\x73\x73" => $ip_address, "\x63\162\145\141\x74\x65\x64\137\157\156" => time(), "\x61\143\164\x69\x76\x65" => $manual_activation === FALSE ? 1 : 0]; goto vNnw1; VGQhn: lmWQ3: goto u2h0z; b6TF8: $this->trigger_events("\145\170\164\x72\141\137\x73\x65\x74"); goto hzRHI; cNoqU: $this->set_error("\141\x63\x63\157\x75\x6e\x74\137\x63\x72\145\141\164\151\157\x6e\137\x6d\151\163\x73\151\156\147\x5f\x64\145\x66\141\x75\x6c\x74\137\x67\x72\x6f\x75\160"); goto gWB9r; hzRHI: $this->db->insert($this->tables["\x75\x73\x65\x72\163"], $user_data); goto w35Jc; gES7a: foreach ($groups as $group) { $this->add_to_group($group, $id); PW6iN: } goto lZoak; SdrIj: $default_group = $query; goto FDE7Z; w35Jc: $id = $this->db->insert_id($this->tables["\165\x73\145\x72\163"] . "\x5f\151\x64\x5f\x73\145\x71"); goto FUsGb; R3iCP: if (!(!$this->config->item("\144\x65\x66\141\165\x6c\164\x5f\147\162\157\x75\x70", "\151\x6f\156\x5f\x61\165\x74\x68") && empty($groups))) { goto TzCLw; } goto cNoqU; z3Lwd: $password = $this->hash_password($password); goto eGrMc; u2h0z: $this->set_error("\141\143\143\x6f\x75\156\164\137\143\162\x65\141\164\x69\157\156\137\144\165\x70\154\151\x63\x61\164\x65\137\151\144\145\156\x74\151\x74\x79"); goto igFN9; FUsGb: if (!(isset($default_group->id) && empty($groups))) { goto M6DqA; } goto r2e77; hxc0Z: M6DqA: goto uwSbH; r2e77: $groups[] = $default_group->id; goto hxc0Z; eGrMc: if (!($password === FALSE)) { goto Ck2gf; } goto VN0TC; ZQQoP: $this->trigger_events("\x70\x72\x65\137\x72\145\x67\151\x73\x74\145\162"); goto BO1mf; COh_y: return FALSE; goto Uip0c; cWuzi: Ck2gf: goto YEeMI; igFN9: return FALSE; goto L2NBf; uwSbH: if (empty($groups)) { goto MQkw7; } goto gES7a; l9J4t: if (!(!isset($query->id) && empty($groups))) { goto RPgbd; } goto eAzNW; e7wmR: $query = $this->db->get_where($this->tables["\x67\162\x6f\165\x70\163"], ["\x6e\141\155\x65" => $this->config->item("\144\x65\x66\x61\x75\x6c\164\x5f\x67\x72\157\165\x70", "\151\157\156\x5f\x61\165\164\x68")], 1)->row(); goto l9J4t; gWB9r: return FALSE; goto cBLLc; L2NBf: jIvOB: goto e7wmR; eAzNW: $this->set_error("\141\143\x63\x6f\x75\x6e\x74\x5f\x63\x72\x65\141\164\151\x6f\x6e\x5f\151\156\166\141\154\x69\144\137\x64\145\x66\x61\x75\154\x74\137\147\162\x6f\165\x70"); goto COh_y; FDE7Z: $ip_address = $this->input->ip_address(); goto z3Lwd; GeIyV: return isset($id) ? $id : FALSE; goto Dmovi; eiPRM: goto jIvOB; goto VGQhn; uIin0: $this->trigger_events("\160\x6f\163\164\137\162\x65\x67\x69\x73\164\145\162"); goto GeIyV; IQ3nm: if ($this->identity_check($identity)) { goto lmWQ3; } goto R3iCP; BO1mf: $manual_activation = $this->config->item("\x6d\x61\x6e\165\141\x6c\137\141\x63\x74\151\x76\x61\164\151\157\x6e", "\151\x6f\156\x5f\x61\x75\164\150"); goto IQ3nm; DVteM: return FALSE; goto cWuzi; vNnw1: $user_data = array_merge($this->_filter_data($this->tables["\165\163\x65\162\163"], $additional_data), $data); goto b6TF8; lZoak: rQXqJ: goto rLWjw; VN0TC: $this->set_error("\x61\143\x63\x6f\x75\156\164\x5f\143\x72\145\141\x74\x69\157\x6e\x5f\165\156\x73\165\143\x63\145\x73\163\146\x75\x6c"); goto DVteM; rLWjw: MQkw7: goto uIin0; Dmovi: } public function login($identity, $password, $remember = FALSE) { goto PZcHW; VsfCa: goto CTorC; goto Q0vTz; kZHNh: if (!(empty($identity) || empty($password))) { goto Jy2Ma; } goto tIV4o; UNPQn: return FALSE; goto rm_yi; dn0RS: return TRUE; goto nOmgu; LHzrF: $this->update_last_login($user->id); goto Dqq3d; x2u9B: return FALSE; goto ZCgKk; M3MZJ: if (!($query->num_rows() === 1)) { goto JbkpP; } goto od5g5; cRFfU: $this->set_error("\x6c\157\x67\151\x6e\137\165\156\163\x75\x63\x63\x65\x73\163\x66\165\x6c\137\156\x6f\x74\x5f\x61\143\x74\151\x76\x65"); goto qSiX9; I90hW: $this->hash_password($password); goto O09ma; w0VFY: $this->trigger_events("\160\x6f\163\164\137\154\157\147\151\x6e\x5f\165\x6e\x73\x75\x63\143\x65\163\163\146\x75\x6c"); goto PKDJ7; od5g5: $user = $query->row(); goto hhcK2; cQ5rM: $query = $this->db->select($this->identity_column . "\54\40\x65\155\x61\151\154\54\40\151\144\x2c\40\160\x61\163\163\x77\x6f\162\144\54\40\141\143\164\x69\166\x65\54\40\154\141\163\x74\137\x6c\157\x67\x69\x6e")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\x65\163\x63")->get($this->tables["\x75\163\x65\162\x73"]); goto SlOpv; rljPc: CTorC: goto G1DMn; EF9He: $this->remember_user($identity); goto rljPc; SvYe7: $this->trigger_events(["\160\157\163\x74\137\x6c\x6f\147\x69\156", "\160\x6f\x73\x74\137\x6c\157\147\151\x6e\137\x73\x75\143\143\x65\163\x73\146\165\154"]); goto d2qzj; W_s8q: return FALSE; goto qYe9t; nOmgu: dnZh6: goto t2pkH; t2pkH: JbkpP: goto I90hW; d2qzj: $this->set_message("\154\157\147\x69\x6e\x5f\x73\165\143\x63\145\x73\x73\x66\165\x6c"); goto dn0RS; qSiX9: return FALSE; goto zVKXF; Q0vTz: K4lui: goto EF9He; q8N0r: $this->session->sess_regenerate(FALSE); goto SvYe7; BukJ6: $this->clear_forgotten_password_code($identity); goto UsuZ6; Ei8u0: if (!($user->active == 0)) { goto UBCBj; } goto vlWue; zJ8Jh: $this->set_error("\x6c\157\x67\x69\156\137\164\151\x6d\145\x6f\x75\164"); goto UNPQn; zVKXF: UBCBj: goto M0ScL; sM9KP: $this->clear_remember_code($identity); goto VsfCa; hhcK2: if (!$this->verify_password($password, $user->password, $identity)) { goto dnZh6; } goto Ei8u0; NyQV7: $this->rehash_password_if_needed($user->password, $identity, $password); goto q8N0r; Dqq3d: $this->clear_login_attempts($identity); goto BukJ6; PZcHW: $this->trigger_events("\160\162\145\137\x6c\x6f\x67\151\156"); goto kZHNh; O09ma: $this->increase_login_attempts($identity); goto w0VFY; RjNv4: $this->trigger_events("\x65\x78\164\x72\x61\137\x77\150\145\162\145"); goto cQ5rM; vlWue: $this->trigger_events("\x70\157\163\x74\137\x6c\157\x67\151\156\137\165\x6e\163\x75\x63\143\x65\x73\x73\x66\165\154"); goto cRFfU; qYe9t: Jy2Ma: goto RjNv4; aQA94: $this->hash_password($password); goto u278c; G1DMn: ZnarO: goto NyQV7; rm_yi: kLdRe: goto M3MZJ; PKDJ7: $this->set_error("\x6c\x6f\x67\x69\156\137\165\156\163\165\143\x63\145\x73\163\x66\165\x6c"); goto x2u9B; ez5CZ: if ($remember) { goto K4lui; } goto sM9KP; UsuZ6: if (!$this->config->item("\x72\x65\x6d\145\155\x62\x65\x72\137\x75\x73\145\162\163", "\151\x6f\x6e\x5f\141\x75\x74\150")) { goto ZnarO; } goto ez5CZ; SlOpv: if (!$this->is_max_login_attempts_exceeded($identity)) { goto kLdRe; } goto aQA94; tIV4o: $this->set_error("\154\x6f\x67\151\x6e\137\165\156\163\x75\143\143\145\163\163\x66\x75\154"); goto W_s8q; M0ScL: $this->set_session($user); goto LHzrF; u278c: $this->trigger_events("\160\157\163\164\137\154\x6f\x67\151\x6e\137\x75\156\163\x75\x63\143\x65\x73\x73\x66\x75\154"); goto zJ8Jh; ZCgKk: } public function recheck_session() { goto SYTuQ; zXR2T: $identity = $this->config->item("\151\x64\x65\156\164\151\x74\x79", "\x69\x6f\x6e\x5f\x61\x75\x74\x68"); goto CLg2u; Txds6: goto XFAU_; goto GnftE; eqbQj: return (bool) $this->session->userdata("\x69\x64\145\x6e\x74\x69\x74\x79"); goto ycuZH; gxmx4: XFAU_: goto yNdpr; rDhPV: if (!($recheck !== 0)) { goto iztCO; } goto QEXpl; IEn29: $this->session->set_userdata("\x6c\141\163\164\x5f\x63\x68\x65\143\x6b", time()); goto gxmx4; iETMN: if ($query->num_rows() === 1) { goto STIyJ; } goto jsx7T; CLg2u: $this->session->unset_userdata([$identity, "\x69\x64", "\x75\163\x65\x72\137\151\144"]); goto yYteL; GnftE: STIyJ: goto IEn29; C0cPy: $query = $this->db->select("\151\x64")->where([$this->identity_column => $this->session->userdata("\x69\144\145\x6e\x74\151\164\x79"), "\x61\143\164\x69\x76\x65" => "\x31"])->limit(1)->order_by("\151\144", "\x64\x65\163\x63")->get($this->tables["\165\x73\145\162\x73"]); goto iETMN; yYteL: return FALSE; goto Txds6; yNdpr: XbpID: goto O_5nX; jsx7T: $this->trigger_events("\x6c\x6f\x67\x6f\x75\x74"); goto zXR2T; SYTuQ: $recheck = NULL !== $this->config->item("\x72\x65\x63\x68\x65\x63\x6b\x5f\x74\151\155\x65\x72", "\151\x6f\x6e\137\x61\165\164\150") ? $this->config->item("\162\x65\x63\x68\x65\x63\153\137\164\x69\x6d\145\x72", "\151\x6f\x6e\137\141\x75\x74\150") : 0; goto rDhPV; QEXpl: $last_login = $this->session->userdata("\154\141\x73\x74\x5f\x63\x68\x65\x63\x6b"); goto FTTPk; FTTPk: if (!($last_login + $recheck < time())) { goto XbpID; } goto C0cPy; O_5nX: iztCO: goto eqbQj; ycuZH: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto FYoHy; m2PF5: if (!($max_attempts > 0)) { goto mIYEU; } goto dcrAX; XJ7R8: mIYEU: goto D6Ov_; dcrAX: $attempts = $this->get_attempts_num($identity, $ip_address); goto bCUBI; cNY78: return FALSE; goto o1KWs; D6Ov_: Hs85K: goto cNY78; FYoHy: if (!$this->config->item("\x74\x72\141\143\x6b\137\154\157\147\151\156\x5f\141\x74\164\x65\x6d\x70\164\x73", "\151\x6f\x6e\137\x61\165\164\150")) { goto Hs85K; } goto Hr5jm; bCUBI: return $attempts >= $max_attempts; goto XJ7R8; Hr5jm: $max_attempts = $this->config->item("\155\x61\x78\x69\155\x75\155\137\x6c\x6f\147\151\156\x5f\141\164\164\145\x6d\x70\164\163", "\151\157\x6e\x5f\141\x75\164\x68"); goto m2PF5; o1KWs: } public function get_attempts_num($identity, $ip_address = NULL) { goto s5Zg7; nSaMO: Y5_Sx: goto OMPOD; DoucS: $qres = $this->db->get($this->tables["\154\x6f\147\151\x6e\137\x61\x74\x74\145\x6d\x70\x74\x73"]); goto NCh0y; s5Zg7: if (!$this->config->item("\x74\x72\141\x63\x6b\x5f\154\x6f\147\x69\156\x5f\141\164\164\x65\155\160\164\x73", "\x69\x6f\156\x5f\x61\x75\164\150")) { goto Y5_Sx; } goto ZM_DF; N1Aoy: if (isset($ip_address)) { goto mKNX2; } goto g0u8Y; aHkcP: mKNX2: goto XNIJZ; nJ0q2: if (!$this->config->item("\x74\x72\x61\x63\x6b\x5f\x6c\157\147\151\156\137\x69\160\x5f\141\144\144\162\145\163\163", "\151\x6f\x6e\137\141\x75\164\x68")) { goto q0EXx; } goto N1Aoy; XNIJZ: $this->db->where("\x69\x70\137\141\144\144\x72\145\163\x73", $ip_address); goto EBGvj; g0u8Y: $ip_address = $this->input->ip_address(); goto aHkcP; EBGvj: q0EXx: goto kwkcC; DpG1j: $this->db->where("\x6c\x6f\147\x69\x6e", $identity); goto nJ0q2; ZM_DF: $this->db->select("\61", FALSE); goto DpG1j; NCh0y: return $qres->num_rows(); goto nSaMO; kwkcC: $this->db->where("\164\x69\x6d\x65\40\76", time() - $this->config->item("\x6c\157\x63\153\x6f\x75\164\x5f\x74\x69\x6d\x65", "\151\x6f\x6e\x5f\141\165\x74\150"), FALSE); goto DoucS; OMPOD: return 0; goto qUalx; qUalx: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto PPInd; d72gz: if (isset($ip_address)) { goto NCSl5; } goto XUfvl; e2Y6z: $this->db->order_by("\x69\x64", "\144\145\163\x63"); goto rFg6f; rFg6f: $qres = $this->db->get($this->tables["\154\157\147\x69\156\137\141\164\164\x65\x6d\160\x74\163"], 1); goto Y_h0u; XUfvl: $ip_address = $this->input->ip_address(); goto x9a46; Y_h0u: if (!($qres->num_rows() > 0)) { goto EKgZA; } goto mWbbi; mWbbi: return $qres->row()->time; goto i6uKl; FfSX0: $this->db->select("\x74\151\155\x65"); goto E0oBG; GR2ke: wGV43: goto e2Y6z; i6uKl: EKgZA: goto Y7Cc2; i6qm3: return 0; goto DJiYb; Y7Cc2: DnxEp: goto i6qm3; x9a46: NCSl5: goto OeH05; PPInd: if (!$this->config->item("\164\x72\x61\x63\x6b\x5f\154\157\x67\151\156\137\141\164\164\145\x6d\160\164\x73", "\x69\x6f\156\137\141\165\x74\x68")) { goto DnxEp; } goto FfSX0; q8dBN: if (!$this->config->item("\x74\162\x61\143\x6b\137\154\157\x67\151\x6e\137\151\160\137\x61\x64\x64\162\145\163\163", "\x69\x6f\x6e\137\x61\x75\x74\x68")) { goto wGV43; } goto d72gz; OeH05: $this->db->where("\151\160\x5f\x61\x64\x64\162\x65\x73\x73", $ip_address); goto GR2ke; E0oBG: $this->db->where("\154\x6f\147\151\x6e", $identity); goto q8dBN; DJiYb: } public function get_last_attempt_ip($identity) { goto JdLLi; qTk0n: iajTs: goto No3LE; wPVlc: return $qres->row()->ip_address; goto qh7xl; No3LE: return ''; goto xZfES; rbu3v: $this->db->order_by("\151\x64", "\x64\145\163\x63"); goto EQlRy; JdLLi: if (!($this->config->item("\x74\162\x61\x63\x6b\x5f\x6c\157\x67\x69\x6e\137\x61\164\164\145\x6d\x70\x74\x73", "\151\157\156\x5f\141\165\x74\150") && $this->config->item("\164\x72\141\143\153\x5f\x6c\x6f\x67\151\x6e\137\151\160\x5f\x61\144\144\162\x65\163\x73", "\x69\157\x6e\x5f\141\165\x74\150"))) { goto iajTs; } goto EEUT4; qh7xl: bfuUu: goto qTk0n; EQlRy: $qres = $this->db->get($this->tables["\x6c\x6f\x67\151\x6e\137\141\164\164\145\x6d\160\x74\x73"], 1); goto J23CF; J23CF: if (!($qres->num_rows() > 0)) { goto bfuUu; } goto wPVlc; EEUT4: $this->db->select("\x69\x70\x5f\141\x64\x64\162\145\x73\163"); goto WEwrZ; WEwrZ: $this->db->where("\x6c\157\x67\151\x6e", $identity); goto rbu3v; xZfES: } public function increase_login_attempts($identity) { goto CxzEW; FCO64: $data["\151\160\137\141\144\144\162\x65\x73\x73"] = $this->input->ip_address(); goto XscR9; CFoQU: $data = ["\x69\x70\x5f\x61\144\144\162\x65\x73\x73" => '', "\154\x6f\x67\151\x6e" => $identity, "\x74\x69\155\145" => time()]; goto AJr1c; CxzEW: if (!$this->config->item("\164\x72\141\x63\x6b\x5f\x6c\157\x67\151\x6e\137\x61\164\x74\145\155\160\164\x73", "\x69\x6f\156\137\x61\165\164\150")) { goto WakNS; } goto CFoQU; hqWsb: return $this->db->insert($this->tables["\154\157\x67\151\x6e\137\141\164\164\145\155\x70\164\163"], $data); goto TbdrV; AJr1c: if (!$this->config->item("\x74\162\x61\143\x6b\x5f\x6c\x6f\x67\x69\x6e\137\151\160\137\141\144\144\x72\x65\163\x73", "\x69\157\156\x5f\x61\165\x74\x68")) { goto MbfRA; } goto FCO64; TbdrV: WakNS: goto DfzLN; DfzLN: return FALSE; goto u2QlK; XscR9: MbfRA: goto hqWsb; u2QlK: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto ltxMW; w6cF7: gMxmk: goto Iz8u9; XSVmu: return $this->db->delete($this->tables["\x6c\x6f\x67\151\156\137\141\164\164\x65\x6d\x70\x74\163"]); goto Fijpt; Iz8u9: $this->db->or_where("\164\151\155\145\40\74", time() - $old_attempts_expire_period, FALSE); goto XSVmu; rUZk6: $ip_address = $this->input->ip_address(); goto x2Zt1; aWFZS: if (isset($ip_address)) { goto bZwWr; } goto rUZk6; OUcVb: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\x6c\x6f\143\153\x6f\165\x74\137\x74\x69\155\145", "\x69\157\156\x5f\x61\165\164\x68")); goto GizAX; x2Zt1: bZwWr: goto BPtOV; GizAX: $this->db->where("\154\157\147\151\156", $identity); goto IVh7e; Fijpt: e8tit: goto J8nZI; ltxMW: if (!$this->config->item("\164\162\141\143\153\137\x6c\x6f\147\151\x6e\137\x61\x74\164\x65\x6d\160\164\163", "\151\157\156\x5f\141\165\164\x68")) { goto e8tit; } goto OUcVb; J8nZI: return FALSE; goto Q3cLt; BPtOV: $this->db->where("\x69\x70\x5f\141\x64\144\x72\145\x73\x73", $ip_address); goto w6cF7; IVh7e: if (!$this->config->item("\x74\162\141\143\x6b\x5f\x6c\x6f\147\x69\156\x5f\151\160\137\141\144\x64\x72\145\x73\163", "\x69\x6f\156\137\141\165\164\x68")) { goto gMxmk; } goto aWFZS; Q3cLt: } public function limit($limit) { goto g22g7; g22g7: $this->trigger_events("\154\x69\155\x69\x74"); goto ZgKzG; QYwJa: return $this; goto mLn5h; ZgKzG: $this->_ion_limit = $limit; goto QYwJa; mLn5h: } public function offset($offset) { goto b6Pnr; IdLPv: $this->_ion_offset = $offset; goto C9MBP; C9MBP: return $this; goto YR6O2; b6Pnr: $this->trigger_events("\157\x66\146\x73\x65\164"); goto IdLPv; YR6O2: } public function where($where, $value = NULL) { goto e7k5Z; Hs4t0: if (is_array($where)) { goto dmyFX; } goto h5g6r; h5g6r: $where = [$where => $value]; goto y93Xz; XX8Ep: array_push($this->_ion_where, $where); goto aKHeN; e7k5Z: $this->trigger_events("\x77\150\x65\x72\x65"); goto Hs4t0; y93Xz: dmyFX: goto XX8Ep; aKHeN: return $this; goto R0_NQ; R0_NQ: } public function like($like, $value = NULL, $position = "\142\157\164\x68") { goto G5ozn; h__Q4: return $this; goto d3hzS; G5ozn: $this->trigger_events("\154\x69\153\x65"); goto Ib0wv; Ib0wv: array_push($this->_ion_like, ["\154\x69\153\145" => $like, "\166\x61\154\x75\145" => $value, "\160\x6f\x73\151\164\151\x6f\156" => $position]); goto h__Q4; d3hzS: } public function select($select) { goto HpaKn; bVI0z: $this->_ion_select[] = $select; goto VNE93; HpaKn: $this->trigger_events("\163\145\x6c\145\x63\164"); goto bVI0z; VNE93: return $this; goto Cwbyv; Cwbyv: } public function order_by($by, $order = "\x64\x65\x73\143") { goto t0TiX; qegQH: $this->_ion_order = $order; goto C7264; y2hs9: $this->_ion_order_by = $by; goto qegQH; C7264: return $this; goto E1eYo; t0TiX: $this->trigger_events("\157\x72\x64\145\x72\137\142\171"); goto y2hs9; E1eYo: } public function row() { goto zWUMw; zWUMw: $this->trigger_events("\x72\x6f\167"); goto lWvfA; W_P5o: return $row; goto hCUrp; lWvfA: $row = $this->response->row(); goto W_P5o; hCUrp: } public function row_array() { goto k2TJd; rK2E9: $row = $this->response->row_array(); goto elHEn; k2TJd: $this->trigger_events(["\x72\x6f\167", "\x72\157\167\137\x61\x72\162\141\171"]); goto rK2E9; elHEn: return $row; goto TFpuG; TFpuG: } public function result() { goto i6rZ3; gHyvY: $result = $this->response->result(); goto ZBoON; ZBoON: return $result; goto BLOXL; i6rZ3: $this->trigger_events("\x72\145\163\165\154\164"); goto gHyvY; BLOXL: } public function result_array() { goto HLz0f; ENy22: $result = $this->response->result_array(); goto HTw2x; HLz0f: $this->trigger_events(["\162\145\163\165\154\164", "\162\x65\163\x75\154\164\137\x61\162\x72\x61\171"]); goto ENy22; HTw2x: return $result; goto eLAt_; eLAt_: } public function num_rows() { goto nn_q_; IW0PZ: $result = $this->response->num_rows(); goto LQ0js; LQ0js: return $result; goto tIlb7; nn_q_: $this->trigger_events(["\156\x75\x6d\x5f\x72\x6f\x77\x73"]); goto IW0PZ; tIlb7: } public function users($groups = NULL) { goto oMnkg; W0rYT: Oi_fZ: goto Xo8NX; CoTFk: $this->_ion_limit = NULL; goto t0YUF; u6QPi: H5Q93: goto scGff; rc0gR: dXlsh: goto MoDrp; EfpjD: foreach ($groups as $group) { goto hn44A; N1VRE: goto WlRlT; goto tuStg; B0HFG: WlRlT: goto bJWbt; bsgAH: $group_names[] = $group; goto N1VRE; F26X0: $group_ids[] = $group; goto B0HFG; tuStg: NfZXh: goto F26X0; hn44A: if (is_numeric($group)) { goto NfZXh; } goto bsgAH; bJWbt: KJOXc: goto PJpFO; PJpFO: } goto xYXwN; mR4CN: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto Gpv7F; } goto r2Y4x; v6CZi: RbTn3: goto JOuv0; C3xcH: Gpv7F: goto hHYEV; hHYEV: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto CoTFk; bHF4y: $this->db->select([$this->tables["\x75\x73\145\162\163"] . "\56\x2a", $this->tables["\x75\x73\x65\x72\163"] . "\x2e\x69\x64\40\141\163\40\151\144", $this->tables["\165\x73\x65\162\x73"] . "\56\151\x64\x20\141\163\40\165\x73\145\x72\137\x69\x64"]); goto Iwsc_; kCHMB: $group_names = []; goto EfpjD; t0YUF: $this->_ion_offset = NULL; goto LH3xX; VICNB: if (empty($group_ids)) { goto Oi_fZ; } goto yeZLf; i1ipl: ofeUd: goto V9NJl; gED8J: foreach ($this->_ion_where as $where) { $this->db->where($where); ux01x: } goto jasr0; ja25I: qJY1J: goto KYNrU; QX231: $groups = [$groups]; goto KXgbJ; jiwWG: $group_ids = []; goto kCHMB; i2nq4: $this->db->limit($this->_ion_limit); goto ReanO; r4SNY: TdoXb: goto mR4CN; roBJS: WA6iu: goto rOJtD; Xu6RX: if (!(isset($groups) && !empty($groups))) { goto ak3AU; } goto fxz_l; scGff: goto FS4RZ; goto C3xcH; AZxoT: ak3AU: goto jiwWG; n2LFv: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\x6f\x72\x5f\x77\x68\145\162\145\x5f\151\x6e" : "\x77\150\x65\x72\145\x5f\151\x6e"; goto z7pti; ZSixj: vqfDk: goto cc3Vh; VCXD8: $this->db->join($this->tables["\x67\162\x6f\165\x70\163"], $this->tables["\x75\x73\x65\162\x73\x5f\147\162\x6f\x75\160\x73"] . "\56" . $this->join["\x67\x72\157\165\160\x73"] . "\x20\x3d\40" . $this->tables["\147\x72\x6f\165\x70\163"] . "\56\151\144", "\x69\156\x6e\x65\162"); goto EX41E; KXgbJ: YNXlq: goto Xu6RX; dfo7o: $this->_ion_order_by = NULL; goto ZSixj; HTGrr: $this->db->join($this->tables["\165\x73\145\162\x73\137\147\x72\x6f\165\160\163"], $this->tables["\165\163\145\162\163\137\147\x72\157\x75\x70\163"] . "\56" . $this->join["\165\163\x65\162\x73"] . "\75" . $this->tables["\x75\x73\145\x72\x73"] . "\x2e\151\144", "\151\156\x6e\145\162"); goto AZxoT; ne8NB: if (is_array($groups)) { goto YNXlq; } goto QX231; wQPWK: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto RbTn3; } goto bHF4y; Xo8NX: JB6NW: goto M7UaI; jasr0: MvGhQ: goto X6KdD; LH3xX: FS4RZ: goto xir0I; z7pti: if (empty($group_names)) { goto FH1fg; } goto VCXD8; cc3Vh: $this->response = $this->db->get($this->tables["\165\x73\145\162\x73"]); goto C0jFT; M7UaI: $this->trigger_events("\x65\170\164\x72\x61\137\x77\x68\145\162\x65"); goto MV4vs; xYXwN: UNYGS: goto n2LFv; PEXGv: $this->_ion_order = NULL; goto dfo7o; xir0I: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto vqfDk; } goto xapxH; JOuv0: foreach ($this->_ion_select as $select) { $this->db->select($select); WN_Nm: } goto rc0gR; Iwsc_: goto WA6iu; goto v6CZi; ReanO: $this->_ion_limit = NULL; goto u6QPi; MV4vs: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto qJY1J; } goto gED8J; fxz_l: $this->db->distinct(); goto HTGrr; oMnkg: $this->trigger_events("\165\163\145\162\x73"); goto wQPWK; Xyva6: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\x69\x6b\x65"], $like["\166\x61\154\x75\145"], $like["\160\157\x73\x69\x74\x69\x6f\x6e"]); Qqli7: } goto i1ipl; xapxH: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto PEXGv; rOJtD: if (!isset($groups)) { goto JB6NW; } goto ne8NB; C0jFT: return $this; goto ReZYr; MoDrp: $this->_ion_select = []; goto roBJS; E1w8l: FH1fg: goto VICNB; EX41E: $this->db->where_in($this->tables["\147\162\x6f\x75\x70\x73"] . "\x2e\156\141\x6d\x65", $group_names); goto E1w8l; r2Y4x: if (!isset($this->_ion_limit)) { goto H5Q93; } goto i2nq4; KYNrU: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto TdoXb; } goto Xyva6; X6KdD: $this->_ion_where = []; goto ja25I; yeZLf: $this->db->{$or_where_in}($this->tables["\x75\163\145\x72\163\x5f\x67\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\147\x72\157\165\x70\x73"], $group_ids); goto W0rYT; V9NJl: $this->_ion_like = []; goto r4SNY; ReZYr: } public function user($id = NULL) { goto K0iqY; AV2Ac: $this->users(); goto I1CB3; mM2Np: $this->where($this->tables["\x75\163\x65\x72\163"] . "\56\x69\x64", $id); goto AV2Ac; sGNEt: $id = isset($id) ? $id : $this->session->userdata("\x75\163\x65\162\137\151\144"); goto oVZvP; egd1J: $this->order_by($this->tables["\165\163\145\162\163"] . "\56\x69\144", "\144\x65\x73\x63"); goto mM2Np; K0iqY: $this->trigger_events("\x75\x73\x65\162"); goto sGNEt; oVZvP: $this->limit(1); goto egd1J; I1CB3: return $this; goto dy3_p; dy3_p: } public function get_users_groups($id = FALSE) { goto wVlIK; OilFQ: return $this->db->select($this->tables["\165\x73\145\162\163\137\x67\x72\x6f\x75\x70\163"] . "\56" . $this->join["\147\x72\x6f\x75\160\163"] . "\40\141\163\40\x69\144\54\40" . $this->tables["\147\x72\x6f\x75\x70\x73"] . "\x2e\156\141\155\x65\x2c\x20" . $this->tables["\147\162\157\165\x70\163"] . "\56\x64\145\163\143\x72\x69\160\x74\x69\157\x6e")->where($this->tables["\x75\163\145\162\163\x5f\147\x72\157\165\160\163"] . "\56" . $this->join["\x75\163\145\162\163"], $id)->join($this->tables["\147\x72\x6f\165\160\163"], $this->tables["\165\x73\x65\x72\x73\x5f\147\162\x6f\165\x70\x73"] . "\x2e" . $this->join["\147\162\157\x75\x70\x73"] . "\75" . $this->tables["\x67\162\157\165\x70\x73"] . "\x2e\151\x64")->get($this->tables["\165\163\145\x72\x73\137\147\162\157\165\x70\x73"]); goto VYVRH; ZvfmE: $id || ($id = $this->session->userdata("\x75\163\x65\x72\x5f\x69\x64")); goto OilFQ; wVlIK: $this->trigger_events("\147\x65\164\137\x75\163\145\162\x73\137\x67\162\157\165\x70"); goto ZvfmE; VYVRH: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto CLQ3p; Q7ODA: return $check_all; goto oYdXs; QTzvG: $id || ($id = $this->session->userdata("\165\163\145\x72\137\x69\144")); goto lP2xS; ArZOg: foreach ($check_group as $key => $value) { goto P6A_f; niKXf: if (!(in_array($value, $groups) xor $check_all)) { goto D4ywd; } goto jiHKK; jiHKK: return !$check_all; goto VGKDO; Mpg2V: bMPkR: goto a1cPN; P6A_f: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto niKXf; VGKDO: D4ywd: goto Mpg2V; a1cPN: } goto k2HCf; Cwucz: UcG_Y: goto bZmNf; k2HCf: vHslW: goto Q7ODA; UDtPs: goto atsB1; goto N9RhX; ihp5a: if (isset($this->_cache_user_in_group[$id])) { goto x9yv2; } goto gIdQb; gIdQb: $users_groups = $this->get_users_groups($id)->result(); goto EYsZl; lP2xS: if (is_array($check_group)) { goto H47e1; } goto lWt4G; bZmNf: $this->_cache_user_in_group[$id] = $groups_array; goto UDtPs; MnHb6: atsB1: goto ArZOg; N9RhX: x9yv2: goto h9PC2; h9PC2: $groups_array = $this->_cache_user_in_group[$id]; goto MnHb6; DgINq: H47e1: goto ihp5a; EYsZl: $groups_array = []; goto VV8jm; CLQ3p: $this->trigger_events("\151\x6e\137\147\x72\157\x75\x70"); goto QTzvG; VV8jm: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; mjy4L: } goto Cwucz; lWt4G: $check_group = [$check_group]; goto DgINq; oYdXs: } public function add_to_group($group_ids, $user_id = FALSE) { goto C0kRV; C0kRV: $this->trigger_events("\141\x64\144\x5f\x74\157\x5f\147\x72\x6f\165\x70"); goto VWCIX; b4Tc1: foreach ($group_ids as $group_id) { goto KQ0NV; Gkpsu: $group_name = $group[0]->name; goto BDDeF; pIg5f: N3ouG: goto FjtPk; lS3KH: $group_name = $this->_cache_groups[$group_id]; goto STIZI; STIZI: e3Oqu: goto OS7L2; nmyBk: if (isset($this->_cache_groups[$group_id])) { goto rmzoS; } goto ddbTD; VnFke: goto e3Oqu; goto m03n3; ddbTD: $group = $this->group($group_id)->result(); goto Gkpsu; OS7L2: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto qkT5H; qkT5H: $return++; goto pIg5f; KQ0NV: if (!$this->db->insert($this->tables["\x75\x73\x65\162\163\x5f\147\x72\x6f\x75\x70\163"], [$this->join["\x67\162\x6f\165\160\x73"] => (float) $group_id, $this->join["\165\x73\x65\162\163"] => (float) $user_id])) { goto N3ouG; } goto nmyBk; m03n3: rmzoS: goto lS3KH; FjtPk: EfI_l: goto Erdhv; BDDeF: $this->_cache_groups[$group_id] = $group_name; goto VnFke; Erdhv: } goto KmJER; oL2Ws: $return = 0; goto b4Tc1; lGGfq: return $return; goto rQnfJ; VWCIX: $user_id || ($user_id = $this->session->userdata("\165\x73\145\x72\x5f\x69\144")); goto tjPSE; KmJER: MWg7P: goto lGGfq; tjPSE: if (is_array($group_ids)) { goto QneTZ; } goto ajAvY; ajAvY: $group_ids = [$group_ids]; goto XjvLB; XjvLB: QneTZ: goto oL2Ws; rQnfJ: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto oykMF; NlD_P: goto iC_Yr; goto XaI0V; Dwtqq: return $return; goto pT7Y4; gbi_3: $this->_cache_user_in_group[$user_id] = []; goto oWknh; zKQRm: if (is_array($group_ids)) { goto tz_2U; } goto X3_vQ; teFFF: if (!empty($user_id)) { goto qiaIH; } goto miw3z; SiCF2: foreach ($group_ids as $group_id) { goto Rl8Y8; Rl8Y8: $this->db->delete($this->tables["\165\x73\145\x72\163\x5f\147\x72\x6f\x75\x70\163"], [$this->join["\x67\x72\157\165\x70\x73"] => (float) $group_id, $this->join["\165\163\145\162\x73"] => (float) $user_id]); goto hAfgm; erE6k: beuO_: goto X1pLl; hAfgm: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto e2QO2; } goto tWYls; tWYls: unset($this->_cache_user_in_group[$user_id][$group_id]); goto gmOdn; gmOdn: e2QO2: goto erE6k; X1pLl: } goto DXCuT; oWknh: Bfcvh: goto NlD_P; XaI0V: aFW3o: goto zKQRm; Y4ZUC: iC_Yr: goto Dwtqq; I4qXf: if (!($return = $this->db->delete($this->tables["\x75\163\x65\162\x73\137\x67\x72\157\165\x70\163"], [$this->join["\165\x73\x65\x72\x73"] => (float) $user_id]))) { goto Bfcvh; } goto gbi_3; qZRZW: qiaIH: goto mRdK_; P_uyA: tz_2U: goto SiCF2; oykMF: $this->trigger_events("\x72\x65\x6d\157\x76\x65\137\x66\x72\157\155\137\x67\162\x6f\165\x70"); goto teFFF; miw3z: return FALSE; goto qZRZW; hDF8u: $return = TRUE; goto Y4ZUC; X3_vQ: $group_ids = [$group_ids]; goto P_uyA; DXCuT: Vjzq7: goto hDF8u; mRdK_: if (!empty($group_ids)) { goto aFW3o; } goto I4qXf; pT7Y4: } public function groups() { goto SJCBj; m04Ch: $this->_ion_offset = NULL; goto DS4uZ; DW472: QYX0t: goto sPEIb; EUsLS: $this->db->limit($this->_ion_limit); goto SowOB; rVjbW: NqnfD: goto vqyYM; LCX9_: Pm3ev: goto IISu8; ECu6D: if (!isset($this->_ion_limit)) { goto Pm3ev; } goto EUsLS; SowOB: $this->_ion_limit = NULL; goto LCX9_; CVtY4: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto iwR2r; } goto BPb2t; CMavW: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto NqnfD; } goto QEh48; cnISh: return $this; goto achw1; SJCBj: $this->trigger_events("\147\x72\157\x75\160\163"); goto CVtY4; vqyYM: $this->response = $this->db->get($this->tables["\147\x72\x6f\165\x70\163"]); goto cnISh; YKjUj: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto JEkJi; nMBdx: LqO1W: goto YKjUj; aJMlw: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto LqO1W; } goto ECu6D; BPb2t: foreach ($this->_ion_where as $where) { $this->db->where($where); tyOBX: } goto DW472; QEh48: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto rVjbW; JEkJi: $this->_ion_limit = NULL; goto m04Ch; rJIaW: iwR2r: goto aJMlw; sPEIb: $this->_ion_where = []; goto rJIaW; DS4uZ: xRZAG: goto CMavW; IISu8: goto xRZAG; goto nMBdx; achw1: } public function group($id = NULL) { goto RaV6d; C8KW1: $this->limit(1); goto iBqqV; hFru4: yR3CI: goto C8KW1; RaV6d: $this->trigger_events("\147\x72\x6f\165\x70"); goto nVgDy; GLShR: $this->where($this->tables["\147\x72\157\165\160\x73"] . "\x2e\151\x64", $id); goto hFru4; nVgDy: if (!isset($id)) { goto yR3CI; } goto GLShR; GzWY6: return $this->groups(); goto lCTet; iBqqV: $this->order_by("\x69\144", "\144\145\x73\x63"); goto GzWY6; lCTet: } public function update($id, array $data) { goto DYtR3; AJxYf: iqPe9: goto aCrrB; dLVik: $data["\160\x61\163\x73\167\x6f\162\x64"] = $this->hash_password($data["\x70\141\x73\x73\x77\x6f\162\x64"], $user->{$this->identity_column}); goto LW_Oa; tRxmx: $this->set_error("\165\x70\x64\x61\164\x65\x5f\165\156\x73\165\143\143\145\x73\x73\146\165\154"); goto kNCgY; WUVtM: $this->db->trans_commit(); goto fraQC; B_0XC: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\x70\x61\163\163\167\157\x72\144", $data) || array_key_exists("\x65\x6d\x61\151\154", $data))) { goto cUU0Z; } goto ePPo0; ktham: $this->trigger_events("\145\170\x74\162\x61\137\x77\x68\145\162\x65"); goto p_e3C; p9WIN: if (!($this->db->trans_status() === FALSE)) { goto bHzdK; } goto j67gm; DpbvW: jT6gh: goto d3fYe; LW_Oa: if (!($data["\160\x61\163\163\x77\157\162\144"] === FALSE)) { goto iqPe9; } goto Z2biT; fraQC: $this->trigger_events(["\160\x6f\163\x74\137\x75\x70\x64\x61\164\145\x5f\x75\163\x65\162", "\160\157\163\x74\137\165\160\144\141\x74\x65\x5f\x75\163\x65\x72\x5f\x73\x75\143\x63\x65\163\x73\146\165\154"]); goto C0XqX; ew6jp: return TRUE; goto BbhxT; vMi1o: $this->set_error("\x61\143\143\157\x75\x6e\164\x5f\x63\x72\145\x61\x74\x69\157\156\x5f\x64\x75\160\x6c\151\x63\x61\x74\145\137\x69\144\x65\x6e\164\151\x74\x79"); goto lg92X; zbDVo: if (!empty($data["\x70\141\163\163\x77\x6f\x72\144"])) { goto TShgW; } goto SHbMV; rSAJI: $this->db->trans_rollback(); goto vMi1o; yuGLf: gwNf_: goto m802y; L5DRF: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto jT6gh; } goto rSAJI; C0XqX: $this->set_message("\165\160\144\141\164\x65\x5f\163\x75\143\x63\145\163\x73\146\x75\154"); goto ew6jp; lg92X: $this->trigger_events(["\x70\157\x73\164\x5f\165\160\144\141\164\x65\x5f\x75\x73\145\x72", "\x70\157\x73\x74\x5f\x75\160\144\141\164\x65\137\165\163\145\162\137\x75\x6e\163\165\143\x63\145\x73\163\146\165\154"]); goto tRxmx; SHbMV: unset($data["\160\x61\x73\163\x77\157\x72\144"]); goto hKbSL; m802y: cUU0Z: goto ktham; d3fYe: $data = $this->_filter_data($this->tables["\x75\x73\x65\162\x73"], $data); goto B_0XC; p_e3C: $this->db->update($this->tables["\x75\163\x65\162\163"], $data, ["\x69\144" => $user->id]); goto p9WIN; l5u9G: bHzdK: goto WUVtM; j67gm: $this->db->trans_rollback(); goto OWykH; kNCgY: return FALSE; goto DpbvW; OWykH: $this->trigger_events(["\x70\157\163\x74\137\x75\160\x64\x61\x74\145\137\x75\x73\x65\x72", "\160\157\163\164\x5f\x75\160\x64\x61\164\x65\x5f\165\x73\145\162\x5f\165\x6e\163\165\143\x63\x65\163\x73\146\165\154"]); goto boQP5; ePPo0: if (!array_key_exists("\x70\x61\x73\163\x77\157\x72\144", $data)) { goto gwNf_; } goto zbDVo; gwi02: $this->trigger_events(["\x70\x6f\163\164\x5f\165\x70\x64\x61\x74\145\137\165\163\145\x72", "\x70\x6f\163\164\137\165\x70\144\141\x74\x65\x5f\x75\x73\145\162\137\165\x6e\x73\165\x63\143\x65\163\163\146\x75\x6c"]); goto gUEOv; hKbSL: goto DvIaj; goto STUHE; DYtR3: $this->trigger_events("\160\162\145\137\165\x70\x64\141\164\x65\137\165\163\x65\162"); goto TwdMD; wld6m: $this->db->trans_begin(); goto L5DRF; gUEOv: $this->set_error("\x75\160\x64\x61\164\145\x5f\165\156\x73\165\x63\143\145\163\x73\x66\x75\154"); goto bwKrB; boQP5: $this->set_error("\x75\x70\144\x61\x74\145\x5f\165\156\163\165\x63\143\145\163\163\146\165\x6c"); goto Qjh34; aCrrB: DvIaj: goto yuGLf; STUHE: TShgW: goto dLVik; TwdMD: $user = $this->user($id)->row(); goto wld6m; Z2biT: $this->db->trans_rollback(); goto gwi02; bwKrB: return FALSE; goto AJxYf; Qjh34: return FALSE; goto l5u9G; BbhxT: } public function delete_user($id) { goto d4G_J; VsBhK: $this->remove_from_group(NULL, $id); goto WZu1u; WZu1u: $this->db->delete($this->tables["\165\x73\x65\x72\163"], ["\x69\144" => $id]); goto dbSzK; C1wzf: $this->db->trans_commit(); goto MklmR; dbSzK: if (!($this->db->trans_status() === FALSE)) { goto cSO3e; } goto DDP0A; MklmR: $this->trigger_events(["\x70\157\x73\x74\137\x64\145\154\x65\x74\145\x5f\165\163\145\162", "\160\x6f\163\x74\x5f\144\145\154\x65\x74\145\137\x75\x73\x65\x72\137\163\165\x63\x63\x65\163\163\146\165\x6c"]); goto w_vlN; rPDr4: $this->db->trans_begin(); goto VsBhK; d4G_J: $this->trigger_events("\x70\x72\145\x5f\144\145\x6c\x65\164\x65\137\x75\163\x65\x72"); goto rPDr4; Z_R3V: return FALSE; goto S2Wh7; S2Wh7: cSO3e: goto C1wzf; t4CTC: $this->set_error("\144\145\x6c\145\x74\145\137\165\156\163\165\x63\x63\x65\163\163\146\x75\x6c"); goto Z_R3V; w_vlN: $this->set_message("\144\145\154\145\x74\x65\x5f\x73\165\x63\x63\145\163\x73\x66\x75\154"); goto g_s_2; PFWQd: $this->trigger_events(["\x70\157\x73\x74\x5f\144\x65\154\x65\x74\145\x5f\165\163\145\162", "\160\157\163\x74\137\144\x65\x6c\145\x74\x65\x5f\165\163\x65\x72\x5f\x75\x6e\163\165\143\x63\x65\163\163\x66\165\x6c"]); goto t4CTC; g_s_2: return TRUE; goto bl1br; DDP0A: $this->db->trans_rollback(); goto PFWQd; bl1br: } public function update_last_login($id) { goto KgD6H; U9N3D: $this->load->helper("\144\141\164\x65"); goto RVK2o; KgD6H: $this->trigger_events("\x75\x70\x64\x61\x74\145\137\x6c\141\x73\x74\137\x6c\x6f\x67\x69\156"); goto U9N3D; AdNWl: $this->db->update($this->tables["\165\x73\x65\x72\x73"], ["\x6c\141\163\164\x5f\x6c\157\147\151\156" => time()], ["\x69\144" => $id]); goto iSzaT; RVK2o: $this->trigger_events("\145\x78\x74\x72\x61\137\x77\150\x65\162\145"); goto AdNWl; iSzaT: return $this->db->affected_rows() == 1; goto UhbxS; UhbxS: } public function set_lang($lang = "\145\156") { goto EalXv; JMDZZ: set_cookie(["\x6e\141\x6d\145" => "\x6c\141\156\147\x5f\143\x6f\144\145", "\x76\141\x6c\165\x65" => $lang, "\x65\170\x70\151\162\x65" => $expire]); goto ETUXm; ETTuX: $expire = self::MAX_COOKIE_LIFETIME; goto LPf0D; D6UiW: $expire = $this->config->item("\x75\x73\145\x72\x5f\x65\x78\160\x69\162\x65", "\x69\x6f\156\x5f\x61\x75\x74\x68"); goto iAhpU; eXD3x: if ($this->config->item("\x75\x73\x65\162\137\x65\170\x70\x69\162\x65", "\x69\157\156\x5f\141\x75\x74\x68") === 0) { goto FGwPS; } goto D6UiW; iAhpU: goto uep06; goto ckz2B; ETUXm: return TRUE; goto Ude9E; LPf0D: uep06: goto JMDZZ; ckz2B: FGwPS: goto ETTuX; EalXv: $this->trigger_events("\x73\145\x74\137\x6c\x61\x6e\x67"); goto eXD3x; Ude9E: } public function set_session($user) { goto hzPG_; hzPG_: $this->trigger_events("\x70\162\x65\x5f\163\145\x74\137\163\x65\x73\163\151\x6f\x6e"); goto eBFu8; bJfvm: return TRUE; goto h4eiG; Js_JA: $this->trigger_events("\x70\x6f\163\164\137\x73\x65\164\137\x73\145\x73\163\x69\x6f\x6e"); goto bJfvm; lzXCQ: $this->session->set_userdata($session_data); goto Js_JA; eBFu8: $session_data = ["\151\144\x65\156\x74\151\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\x65\155\x61\x69\154" => $user->email, "\165\163\x65\162\x5f\x69\x64" => $user->id, "\157\x6c\x64\137\154\141\x73\x74\137\154\157\x67\x69\156" => $user->last_login, "\x6c\141\x73\x74\x5f\x63\150\x65\x63\153" => time()]; goto lzXCQ; h4eiG: } public function remember_user($identity) { goto ZON90; F8i3Q: if ($this->config->item("\165\163\x65\162\x5f\145\170\x70\x69\x72\x65", "\151\x6f\156\137\x61\x75\164\150") === 0) { goto y5bGU; } goto xmwHT; xmwHT: $expire = $this->config->item("\165\x73\145\x72\137\145\x78\160\151\162\x65", "\151\157\x6e\137\x61\x75\x74\x68"); goto xgS06; Te2nY: return FALSE; goto wgh6k; vPNB_: if (!($this->db->affected_rows() > -1)) { goto fmXYt; } goto F8i3Q; ZON90: $this->trigger_events("\160\x72\x65\137\x72\x65\155\145\155\x62\145\x72\137\x75\163\x65\x72"); goto I8BeG; dTzFP: b3FMF: goto ymB7h; saFmN: set_cookie(["\x6e\141\x6d\145" => $this->config->item("\162\145\155\x65\x6d\142\x65\x72\137\143\x6f\157\153\x69\145\137\156\x61\x6d\145", "\x69\x6f\156\x5f\141\x75\x74\150"), "\166\x61\154\x75\145" => $token->user_code, "\145\170\160\x69\162\x65" => $expire]); goto s_gZJ; s_gZJ: $this->trigger_events(["\x70\x6f\x73\x74\x5f\162\x65\x6d\x65\155\142\x65\x72\137\165\163\145\x72", "\162\145\x6d\145\x6d\142\145\x72\137\x75\x73\x65\162\x5f\163\x75\143\x63\x65\163\163\146\x75\154"]); goto d3EqH; ymB7h: $this->trigger_events(["\160\157\163\164\x5f\162\145\x6d\145\x6d\142\145\x72\137\165\163\x65\162", "\x72\145\x6d\x65\x6d\142\145\162\x5f\165\x73\x65\x72\x5f\165\x6e\163\165\x63\x63\145\163\x73\x66\165\x6c"]); goto Te2nY; q9NFR: fmXYt: goto dTzFP; jifRG: jPPP_: goto saFmN; SrggI: $this->db->update($this->tables["\165\x73\145\162\163"], ["\x72\145\155\145\x6d\142\x65\x72\137\x73\x65\x6c\x65\x63\164\157\x72" => $token->selector, "\x72\145\155\145\155\x62\x65\162\137\x63\x6f\144\x65" => $token->validator_hashed], [$this->identity_column => $identity]); goto vPNB_; mxZF1: if (!$token->validator_hashed) { goto b3FMF; } goto SrggI; qOq1I: AL0ZA: goto oAjAp; RX8d4: return FALSE; goto qOq1I; oAjAp: $token = $this->_generate_selector_validator_couple(); goto mxZF1; sAskE: y5bGU: goto Vlk71; Vlk71: $expire = self::MAX_COOKIE_LIFETIME; goto jifRG; d3EqH: return TRUE; goto q9NFR; xgS06: goto jPPP_; goto sAskE; I8BeG: if ($identity) { goto AL0ZA; } goto RX8d4; wgh6k: } public function login_remembered_user() { goto IH68s; cfhO1: if (!($query->num_rows() === 1)) { goto QBz_0; } goto TFbTO; ZEJA_: delete_cookie($this->config->item("\x72\145\155\x65\155\142\x65\x72\x5f\x63\157\157\x6b\x69\x65\x5f\156\141\x6d\x65", "\x69\157\x6e\137\x61\165\x74\150")); goto JZt7p; aaN6z: $identity = $user->{$this->identity_column}; goto STuct; TFbTO: $user = $query->row(); goto aaN6z; UFunC: $query = $this->db->select($this->identity_column . "\x2c\40\151\x64\x2c\40\145\x6d\141\151\154\54\40\x72\145\155\145\155\x62\145\x72\137\x63\x6f\144\x65\x2c\x20\x6c\x61\163\164\x5f\x6c\157\147\x69\x6e")->where("\x72\145\x6d\x65\x6d\x62\x65\x72\x5f\x73\x65\154\x65\143\x74\157\162", $token->selector)->where("\141\143\164\x69\166\145", 1)->limit(1)->get($this->tables["\x75\163\x65\x72\163"]); goto cfhO1; I8_sx: if (!($token === FALSE)) { goto xQYO1; } goto pbv5i; gcdtG: if (!$this->config->item("\165\163\x65\x72\x5f\145\x78\x74\145\x6e\x64\x5f\157\x6e\x5f\x6c\157\147\x69\x6e", "\x69\157\156\x5f\x61\165\x74\150")) { goto APc7z; } goto LrgC6; v1GBj: $this->session->sess_regenerate(FALSE); goto yGHxO; yTwyd: $this->clear_forgotten_password_code($identity); goto gcdtG; IH68s: $this->trigger_events("\x70\162\145\137\154\x6f\147\151\156\137\162\x65\155\145\x6d\142\145\x72\145\144\137\x75\163\145\x72"); goto tHqOl; HFAoq: return TRUE; goto F2TKk; ezDA_: $this->update_last_login($user->id); goto xqByf; EsT1n: $this->trigger_events("\x65\170\x74\162\141\x5f\167\150\145\x72\145"); goto UFunC; d2Q0Z: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto I8_sx; F2TKk: pSwCZ: goto F1Fnf; F1Fnf: QBz_0: goto ZEJA_; xqByf: $this->set_session($user); goto yTwyd; TYOeb: APc7z: goto v1GBj; kfx7m: xQYO1: goto EsT1n; STuct: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto pSwCZ; } goto ezDA_; tHqOl: $remember_cookie = get_cookie($this->config->item("\162\x65\x6d\145\155\142\x65\162\137\143\157\x6f\x6b\151\x65\x5f\156\x61\155\145", "\x69\157\156\x5f\141\x75\164\150")); goto d2Q0Z; v2MH3: return FALSE; goto ETGS6; JZt7p: $this->trigger_events(["\x70\x6f\163\x74\137\154\157\147\x69\x6e\x5f\162\x65\x6d\x65\155\142\x65\x72\x65\x64\x5f\x75\163\145\x72", "\160\x6f\x73\164\137\154\x6f\147\151\x6e\137\162\145\x6d\145\x6d\142\145\x72\x65\144\137\165\163\145\162\x5f\x75\x6e\x73\165\143\x63\145\163\x73\x66\x75\x6c"]); goto v2MH3; rxMCf: return FALSE; goto kfx7m; LrgC6: $this->remember_user($identity); goto TYOeb; pbv5i: $this->trigger_events(["\160\x6f\x73\x74\137\x6c\x6f\147\x69\156\137\162\x65\155\145\x6d\142\145\162\x65\x64\x5f\x75\163\145\x72", "\x70\157\163\x74\137\x6c\x6f\x67\x69\x6e\137\162\145\x6d\145\155\x62\x65\162\x65\x64\x5f\165\x73\145\x72\x5f\x75\x6e\x73\165\143\x63\145\163\x73\x66\165\x6c"]); goto rxMCf; yGHxO: $this->trigger_events(["\160\x6f\x73\164\x5f\x6c\x6f\x67\151\156\x5f\x72\x65\155\x65\x6d\x62\145\162\x65\x64\x5f\165\x73\x65\x72", "\160\157\x73\x74\x5f\x6c\157\147\151\x6e\137\162\145\155\145\155\x62\x65\162\145\x64\x5f\165\x73\145\x72\137\x73\165\143\143\x65\163\x73\146\x75\x6c"]); goto HFAoq; ETGS6: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto F1o5R; evGPd: B1_EA: goto XIPxU; o9Fjz: ZLnAh: goto x4kFO; RAe65: $this->set_error("\147\162\157\165\160\137\x6e\141\x6d\x65\x5f\x72\x65\x71\x75\x69\162\145\144"); goto HsgqP; odqMC: $this->set_message("\147\x72\157\x75\x70\137\x63\162\x65\141\x74\151\157\x6e\137\x73\165\x63\143\x65\x73\163\x66\x75\x6c"); goto SyZz7; Denl3: $this->set_error("\x67\x72\157\x75\160\137\x61\x6c\x72\x65\141\x64\171\x5f\145\x78\151\163\164\x73"); goto d8H_J; XIPxU: $this->trigger_events("\x65\170\x74\162\x61\137\147\162\x6f\165\160\137\x73\145\164"); goto hMwIS; F1o5R: if ($group_name) { goto ZLnAh; } goto RAe65; iLM1j: if (!($existing_group !== 0)) { goto I976D; } goto Denl3; d8H_J: return FALSE; goto a3LMn; hMwIS: $this->db->insert($this->tables["\147\x72\x6f\165\x70\163"], $data); goto KE9NS; ZzKyw: if (empty($additional_data)) { goto B1_EA; } goto HN2SQ; KE9NS: $group_id = $this->db->insert_id($this->tables["\147\x72\157\165\160\163"] . "\137\151\144\137\163\x65\x71"); goto odqMC; HsgqP: return FALSE; goto o9Fjz; WG9SS: $data = ["\x6e\141\155\145" => $group_name, "\x64\145\x73\143\x72\151\160\x74\x69\x6f\156" => $group_description]; goto ZzKyw; x4kFO: $existing_group = $this->db->get_where($this->tables["\x67\162\157\165\x70\163"], ["\156\x61\x6d\x65" => $group_name])->num_rows(); goto iLM1j; SyZz7: return $group_id; goto VHlmX; a3LMn: I976D: goto WG9SS; HN2SQ: $data = array_merge($this->_filter_data($this->tables["\147\162\x6f\165\160\x73"], $additional_data), $data); goto evGPd; VHlmX: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto lI5Rt; HA0Gj: return FALSE; goto Qy2AM; wTx7D: $group = $this->db->get_where($this->tables["\147\x72\157\165\160\x73"], ["\151\x64" => $group_id])->row(); goto uydSj; PPymI: DK37r: goto hRhI0; DwmDe: $this->set_message("\147\x72\x6f\165\x70\x5f\165\160\144\141\x74\x65\x5f\163\165\x63\x63\x65\163\163\x66\165\154"); goto hvQSu; Gkq50: if (empty($group_name)) { goto Z_ZXM; } goto YXNyb; YXNyb: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\165\x70\x73"], ["\x6e\x61\x6d\145" => $group_name])->row(); goto oawIz; rsRNB: if (empty($additional_data)) { goto DK37r; } goto JZwC3; Qy2AM: iHyhd: goto rsRNB; lI5Rt: if (!empty($group_id)) { goto udfQz; } goto t8Vye; Hkz9o: return FALSE; goto PfLcp; ckCT5: Z_ZXM: goto wTx7D; PfLcp: SuwIX: goto kh1Vt; oawIz: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto SuwIX; } goto FcF71; whg2J: $this->set_error("\147\162\157\165\160\137\156\x61\155\145\137\141\x64\155\151\156\x5f\156\157\x74\x5f\x61\154\164\145\x72"); goto HA0Gj; JZwC3: $data = array_merge($this->_filter_data($this->tables["\147\162\157\x75\x70\x73"], $additional_data), $data); goto PPymI; kh1Vt: $data["\x6e\x61\x6d\x65"] = $group_name; goto ckCT5; uydSj: if (!($this->config->item("\x61\144\155\x69\x6e\x5f\147\x72\x6f\165\x70", "\x69\157\156\137\141\x75\x74\150") === $group->name && $group_name !== $group->name)) { goto iHyhd; } goto whg2J; E3TzG: udfQz: goto QNj3P; hvQSu: return TRUE; goto pZljg; QNj3P: $data = []; goto Gkq50; hRhI0: $this->db->update($this->tables["\x67\162\157\x75\160\163"], $data, ["\x69\144" => $group_id]); goto DwmDe; t8Vye: return FALSE; goto E3TzG; FcF71: $this->set_error("\x67\162\157\x75\160\137\x61\154\x72\145\141\144\x79\137\x65\170\x69\x73\x74\163"); goto Hkz9o; pZljg: } public function delete_group($group_id = FALSE) { goto Z43w6; ExUsJ: $this->trigger_events(["\160\x6f\163\164\137\144\x65\154\x65\x74\145\137\x67\x72\157\165\x70", "\160\157\x73\164\137\144\145\x6c\145\x74\x65\137\x67\x72\157\165\160\137\x73\165\143\x63\145\x73\163\x66\x75\x6c"]); goto C2AhM; jkjyR: $this->trigger_events(["\160\x6f\x73\x74\137\144\x65\154\145\164\145\137\147\162\157\x75\160", "\x70\x6f\163\x74\137\144\x65\154\x65\164\x65\137\x67\x72\x6f\x75\x70\x5f\x75\156\x73\x75\x63\143\x65\x73\163\x66\165\154"]); goto xUDD_; CLI_U: EbySu: goto VJRsd; njk8t: if (!($group->name == $this->config->item("\x61\x64\x6d\151\x6e\x5f\x67\162\157\165\x70", "\x69\x6f\x6e\137\x61\165\x74\x68"))) { goto EbySu; } goto KyK1V; drUu5: return FALSE; goto GmT8o; YZsV_: return FALSE; goto CLI_U; AXc2K: $this->db->trans_commit(); goto ExUsJ; EEvCh: $this->set_error("\x67\162\157\x75\160\137\x64\x65\x6c\x65\x74\x65\137\x6e\x6f\x74\x61\154\x6c\157\167\145\x64"); goto YZsV_; SsqA9: return TRUE; goto jksYe; xUDD_: $this->set_error("\147\162\157\x75\x70\x5f\x64\x65\154\145\164\x65\137\x75\156\x73\x75\x63\x63\145\x73\163\146\165\154"); goto Ouk7Q; Z43w6: if (!(!$group_id || empty($group_id))) { goto P96jF; } goto drUu5; Ouk7Q: return FALSE; goto ks7Ks; CmTXx: $this->db->delete($this->tables["\x75\163\145\162\x73\137\x67\162\x6f\x75\160\x73"], [$this->join["\147\x72\157\x75\x70\163"] => $group_id]); goto K4QMb; osdgv: $group = $this->group($group_id)->row(); goto njk8t; KyK1V: $this->trigger_events(["\160\x6f\163\164\137\x64\145\154\x65\164\145\x5f\x67\x72\x6f\165\160", "\160\157\x73\x74\137\x64\x65\x6c\x65\164\145\137\147\x72\x6f\x75\x70\137\x6e\157\x74\141\154\154\x6f\x77\145\x64"]); goto EEvCh; n0ACx: $this->db->trans_begin(); goto CmTXx; C2AhM: $this->set_message("\x67\162\x6f\165\x70\x5f\144\145\x6c\145\x74\x65\137\163\165\143\143\x65\x73\x73\x66\165\154"); goto SsqA9; VJRsd: $this->trigger_events("\x70\x72\x65\137\144\145\x6c\145\x74\145\137\x67\x72\157\x75\x70"); goto n0ACx; K4QMb: $this->db->delete($this->tables["\x67\x72\157\x75\160\x73"], ["\x69\x64" => $group_id]); goto qcNv8; ks7Ks: f1cfW: goto AXc2K; GmT8o: P96jF: goto osdgv; HnVSL: $this->db->trans_rollback(); goto jkjyR; qcNv8: if (!($this->db->trans_status() === FALSE)) { goto f1cfW; } goto HnVSL; jksYe: } public function set_hook($event, $name, $class, $method, $arguments) { goto qxqB_; qxqB_: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto wMNUO; R8Z68: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto tMS9d; c64mx: $this->_ion_hooks->{$event}[$name]->method = $method; goto R8Z68; wMNUO: $this->_ion_hooks->{$event}[$name]->class = $class; goto c64mx; tMS9d: } public function remove_hook($event, $name) { goto AdzmH; AdzmH: if (!isset($this->_ion_hooks->{$event}[$name])) { goto XVPl2; } goto X_YJV; X_YJV: unset($this->_ion_hooks->{$event}[$name]); goto qio8m; qio8m: XVPl2: goto RJJvR; RJJvR: } public function remove_hooks($event) { goto OyyPS; T9rxv: unset($this->_ion_hooks->{$event}); goto MsObc; MsObc: lF8Tm: goto wfNNy; OyyPS: if (!isset($this->_ion_hooks->{$event})) { goto lF8Tm; } goto T9rxv; wfNNy: } protected function _call_hook($event, $name) { goto lmO9g; lmO9g: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto HPU5W; } goto dyiqq; we29T: return FALSE; goto SV8p7; dyiqq: $hook = $this->_ion_hooks->{$event}[$name]; goto lN4FN; cUPNU: HPU5W: goto we29T; lN4FN: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto cUPNU; SV8p7: } public function trigger_events($events) { goto OXPVj; b59Zi: ZBWyq: goto g7tiH; k76Hs: goto Ig9jp; goto VwF3A; OXPVj: if (is_array($events) && !empty($events)) { goto l_T3d; } goto Zcw6S; VwF3A: l_T3d: goto CTkxz; g7tiH: R3wD4: goto k76Hs; j59Ti: JHk_O: goto qtuUq; xEs1D: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); YmuxD: } goto b59Zi; CTkxz: foreach ($events as $event) { $this->trigger_events($event); hU708: } goto j59Ti; qtuUq: Ig9jp: goto qiMNX; Zcw6S: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto R3wD4; } goto xEs1D; qiMNX: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto DyMRo; UEoGg: $this->message_end_delimiter = $end_delimiter; goto K0whw; DyMRo: $this->message_start_delimiter = $start_delimiter; goto UEoGg; K0whw: return TRUE; goto n2ixy; n2ixy: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto hnOPW; kSs2t: $this->error_end_delimiter = $end_delimiter; goto SZbFz; hnOPW: $this->error_start_delimiter = $start_delimiter; goto kSs2t; SZbFz: return TRUE; goto Hv4eL; Hv4eL: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto BMeXt; BMeXt: $_output = ''; goto a6jlP; a6jlP: foreach ($this->messages as $message) { goto jTKRN; sR7_Q: wijhQ: goto yxzVW; MZPaU: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto sR7_Q; jTKRN: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\43\43"; goto MZPaU; yxzVW: } goto ahIWA; wmt2h: return $_output; goto AkXQM; ahIWA: Ef8Mf: goto wmt2h; AkXQM: } public function messages_array($langify = TRUE) { goto QA8vU; SynL9: $_output = []; goto sbfKJ; dZXdu: return $this->messages; goto wZ2k0; vK5VM: deMWm: goto Bl9_a; sbfKJ: foreach ($this->messages as $message) { goto lkDMK; lkDMK: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\x23" . $message . "\43\x23"; goto Ij4D7; Ij4D7: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto edr99; edr99: GFwMg: goto t3l5m; t3l5m: } goto vK5VM; IoFEg: nXgmY: goto ieh8e; wZ2k0: goto nXgmY; goto RZDhS; Bl9_a: return $_output; goto IoFEg; RZDhS: duIYJ: goto SynL9; QA8vU: if ($langify) { goto duIYJ; } goto dZXdu; ieh8e: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto vbEkO; AhdzE: sXgVk: goto gXbwy; vbEkO: $_output = ''; goto NivEN; gXbwy: return $_output; goto f0dY_; NivEN: foreach ($this->errors as $error) { goto AdGde; AdGde: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\43" . $error . "\43\x23"; goto FjeOd; FjeOd: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto eJwyX; eJwyX: ywf_Q: goto Yc2Mv; Yc2Mv: } goto AhdzE; f0dY_: } public function errors_array($langify = TRUE) { goto VKILy; IoLz1: foreach ($this->errors as $error) { goto BXmFg; chpWY: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto PopY4; BXmFg: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\43\x23" . $error . "\x23\43"; goto chpWY; PopY4: wMvl3: goto e2wwk; e2wwk: } goto orgSg; B8Fd9: return $_output; goto JceWm; JceWm: YIA_n: goto ddYLH; U2U5O: ZSbAR: goto vBnYD; orgSg: H8FzE: goto B8Fd9; vBnYD: $_output = []; goto IoLz1; m6U58: return $this->errors; goto CmU3f; CmU3f: goto YIA_n; goto U2U5O; VKILy: if ($langify) { goto ZSbAR; } goto m6U58; ddYLH: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto AmO4O; I31Cf: $this->trigger_events("\x65\170\164\162\141\137\167\150\x65\x72\145"); goto wFU9A; AmO4O: $hash = $this->hash_password($password, $identity); goto MQQuu; GMzX3: return $this->db->affected_rows() == 1; goto Wap1e; wFU9A: $this->db->update($this->tables["\x75\x73\x65\162\163"], $data, [$this->identity_column => $identity]); goto GMzX3; ZhiVc: i3F0J: goto u9lHO; ElGep: return FALSE; goto ZhiVc; u9lHO: $data = ["\160\141\x73\x73\167\x6f\x72\144" => $hash, "\162\x65\155\x65\x6d\x62\x65\162\137\143\x6f\x64\145" => NULL, "\x66\157\162\x67\157\x74\164\x65\156\x5f\x70\141\x73\163\x77\157\162\144\x5f\143\157\x64\x65" => NULL, "\146\x6f\x72\x67\157\x74\164\145\156\x5f\160\141\x73\x73\167\x6f\x72\144\x5f\x74\x69\x6d\145" => NULL]; goto I31Cf; MQQuu: if (!($hash === FALSE)) { goto i3F0J; } goto ElGep; Wap1e: } protected function _filter_data($table, $data) { goto SHu5f; SHu5f: $filtered_data = []; goto E36N7; n2LvC: if (!is_array($data)) { goto jOYLJ; } goto fKJbD; t6L91: return $filtered_data; goto P5_P7; qyQ03: hPjlj: goto iiv2Y; fKJbD: foreach ($columns as $column) { goto bksym; rgvjC: AzfZ8: goto NkMh9; b0vp6: $filtered_data[$column] = $data[$column]; goto qqG3o; qqG3o: KwTos: goto rgvjC; bksym: if (!array_key_exists($column, $data)) { goto KwTos; } goto b0vp6; NkMh9: } goto qyQ03; iiv2Y: jOYLJ: goto t6L91; E36N7: $columns = $this->db->list_fields($table); goto n2LvC; P5_P7: } protected function _random_token($result_length = 32) { goto K0Fux; z3hF7: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto WQz70; CLjNd: xb7j9: goto uBSor; K0Fux: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto phdvE; } goto cjSXN; c2jRa: if (!function_exists("\x6d\x63\x72\171\x70\x74\x5f\x63\162\x65\141\x74\x65\137\x69\x76")) { goto yLn7l; } goto z3hF7; uBSor: return FALSE; goto x2dPG; qVb43: mAJ5x: goto c2jRa; q_OGI: if (!function_exists("\x72\141\x6e\144\157\x6d\x5f\142\171\x74\x65\x73")) { goto mAJ5x; } goto baEeg; WQz70: yLn7l: goto w4vyA; jDegf: phdvE: goto q_OGI; jOMVy: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto CLjNd; cjSXN: $result_length = 32; goto jDegf; w4vyA: if (!function_exists("\157\160\145\156\x73\163\x6c\137\162\x61\156\144\157\x6d\x5f\160\x73\145\165\x64\x6f\x5f\142\171\x74\x65\163")) { goto xb7j9; } goto jOMVy; baEeg: return bin2hex(random_bytes($result_length / 2)); goto qVb43; x2dPG: } protected function _get_hash_parameters($identity = NULL) { goto MpDTW; kcR52: switch ($this->hash_method) { case "\x62\143\162\x79\160\x74": $params = ["\x63\157\x73\x74" => $is_admin ? $this->config->item("\142\x63\162\171\160\x74\137\141\144\155\151\156\x5f\143\x6f\163\164", "\x69\x6f\x6e\x5f\141\165\164\150") : $this->config->item("\142\x63\162\171\160\x74\x5f\x64\x65\x66\141\165\x6c\x74\x5f\x63\x6f\x73\164", "\x69\157\x6e\x5f\141\x75\x74\x68")]; goto WclHR; case "\x61\162\147\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\162\147\x6f\x6e\62\137\x61\x64\155\x69\x6e\137\x70\x61\x72\141\155\163", "\x69\157\x6e\137\x61\165\164\x68") : $this->config->item("\x61\162\x67\157\156\62\x5f\x64\x65\146\x61\165\154\164\x5f\160\141\x72\141\155\x73", "\151\x6f\x6e\x5f\x61\x75\x74\x68"); goto WclHR; default: } goto lRunC; oq_At: WclHR: goto zN1rq; MpDTW: $is_admin = FALSE; goto jmiLn; M4TIB: $user_id = $this->get_user_id_from_identity($identity); goto GQmU8; jmiLn: if (!$identity) { goto FSwex; } goto M4TIB; zN1rq: return $params; goto mmLJ4; OAPQU: $params = FALSE; goto kcR52; zK8Pq: FSwex: goto OAPQU; lRunC: q2PXs: goto oq_At; LSeTX: $is_admin = TRUE; goto fCoEp; GQmU8: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\151\x6e\x5f\147\162\157\x75\160", "\x69\x6f\156\x5f\141\x75\x74\x68"), $user_id))) { goto XF3vR; } goto LSeTX; fCoEp: XF3vR: goto zK8Pq; mmLJ4: } protected function _get_hash_algo() { goto zzFqs; zzFqs: $algo = FALSE; goto q_kgP; q_kgP: switch ($this->hash_method) { case "\x62\143\162\x79\160\164": $algo = PASSWORD_BCRYPT; goto BrqEn; case "\x61\162\x67\x6f\156\x32": $algo = PASSWORD_ARGON2I; goto BrqEn; default: } goto lTH5Z; V4jYQ: BrqEn: goto rA1I3; rA1I3: return $algo; goto p4V7v; lTH5Z: pNGKu: goto V4jYQ; p4V7v: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto ewGbW; uHEU4: $validator = $this->_random_token($validator_size); goto q460V; q460V: $validator_hashed = $this->hash_password($validator); goto IwmCU; IwmCU: $user_code = "{$selector}\x2e{$validator}"; goto JsJEA; ewGbW: $selector = $this->_random_token($selector_size); goto uHEU4; JsJEA: return (object) ["\163\145\x6c\x65\x63\164\157\x72" => $selector, "\166\x61\154\x69\144\x61\x74\x6f\162\x5f\x68\141\163\x68\x65\144" => $validator_hashed, "\165\163\145\162\x5f\143\x6f\144\x65" => $user_code]; goto Qvair; Qvair: } protected function _retrieve_selector_validator_couple($user_code) { goto NIh58; gyoVd: return (object) ["\x73\145\x6c\145\143\x74\157\x72" => $tokens[0], "\x76\141\154\151\144\141\x74\x6f\162" => $tokens[1]]; goto N9FRw; jLxGK: return FALSE; goto XdBDt; v4Auj: j0AVz: goto jLxGK; CHEvl: $tokens = explode("\56", $user_code); goto pg3V_; N9FRw: IQJkS: goto v4Auj; pg3V_: if (!(count($tokens) === 2)) { goto IQJkS; } goto gyoVd; NIh58: if (!$user_code) { goto j0AVz; } goto CHEvl; XdBDt: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto uhQ4O; ZWxpC: wz5rl: goto gethC; FFMGj: goto cF78t; goto w1hf_; oacNr: return FALSE; goto ZWxpC; di85a: znnzQ: goto th4ma; N022y: $this->trigger_events(["\160\157\163\x74\x5f\163\x68\x61\x31\x5f\x70\141\163\x73\167\157\162\x64\x5f\155\x69\x67\x72\x61\164\151\157\156", "\160\x6f\x73\x74\137\163\150\x61\61\x5f\x70\x61\x73\x73\167\x6f\162\144\137\x6d\151\x67\162\x61\164\x69\157\x6e\137\x75\156\x73\x75\143\143\145\x73\x73\146\165\x6c"]); goto Tlgfj; xA0gO: if ($this->config->item("\x73\x74\x6f\162\x65\x5f\x73\x61\x6c\164", "\151\157\x6e\x5f\x61\x75\x74\150")) { goto XbKgL; } goto NZBOv; vkkdw: goto nXjDd; goto di85a; KxLre: $query = $this->db->select("\x73\141\x6c\x74")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\x65\x72\163"]); goto zlro1; SjovB: $this->trigger_events(["\x70\157\x73\164\x5f\163\150\141\x31\137\x70\x61\x73\x73\x77\x6f\x72\x64\x5f\155\x69\x67\x72\x61\x74\x69\157\x6e", "\160\157\163\164\x5f\163\150\141\x31\x5f\160\x61\163\163\x77\157\x72\144\137\155\151\x67\x72\141\164\x69\157\x6e\137\x75\156\x73\165\143\x63\x65\163\x73\146\165\154"]); goto gp6R2; mvF36: Nolui: goto Fiqs7; femuZ: if ($salt_length) { goto wz5rl; } goto ms8n0; a6RZ9: ieAu2: goto nrwcP; uhQ4O: $this->trigger_events("\x70\162\x65\137\x73\150\x61\61\137\x70\141\x73\x73\x77\x6f\162\x64\x5f\x6d\x69\147\162\141\x74\x69\x6f\156"); goto xA0gO; gethC: $salt = substr($hashed_password_db, 0, $salt_length); goto heKSp; gp6R2: return FALSE; goto vkkdw; w1hf_: XbKgL: goto KxLre; Tlgfj: goto Nolui; goto MI3S0; L8B1s: $this->trigger_events(["\x70\157\163\x74\x5f\163\150\x61\61\137\x70\141\x73\163\167\157\162\x64\x5f\x6d\x69\x67\x72\x61\x74\151\157\156", "\160\157\163\x74\137\x73\x68\141\x31\x5f\x70\141\163\x73\x77\x6f\162\x64\137\x6d\151\147\162\141\164\x69\x6f\x6e\137\163\165\x63\143\x65\163\x73\x66\165\x6c"]); goto mvF36; dRlv7: nXjDd: goto sIQMl; WJVy9: if ($hashed_password === $hashed_password_db) { goto znnzQ; } goto SjovB; SQ2Of: if (!($query->num_rows() !== 1)) { goto ieAu2; } goto yA0gO; nrwcP: $hashed_password = sha1($password . $salt_db->salt); goto IeKaZ; fRmMi: if ($result) { goto RbxSv; } goto N022y; MI3S0: RbxSv: goto L8B1s; heKSp: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto FFMGj; IeKaZ: cF78t: goto WJVy9; ms8n0: $this->trigger_events(["\x70\157\x73\164\x5f\x73\150\141\61\137\160\x61\163\x73\x77\157\x72\x64\137\155\151\147\162\x61\164\x69\157\x6e", "\x70\x6f\x73\164\x5f\163\x68\141\61\137\x70\141\x73\163\167\157\162\x64\137\155\151\147\x72\x61\164\151\x6f\x6e\137\165\x6e\163\x75\x63\x63\x65\163\x73\146\165\154"]); goto oacNr; yA0gO: $this->trigger_events(["\x70\157\x73\x74\137\163\150\x61\61\x5f\160\x61\x73\163\x77\x6f\x72\144\x5f\155\151\147\162\x61\164\151\157\x6e", "\160\x6f\x73\164\x5f\163\x68\141\61\x5f\x70\141\x73\163\x77\x6f\162\144\x5f\155\151\147\x72\x61\x74\151\157\x6e\137\165\156\x73\x75\143\143\x65\x73\163\x66\165\154"]); goto YrJ46; YrJ46: return FALSE; goto a6RZ9; Fiqs7: return $result; goto dRlv7; NZBOv: $salt_length = $this->config->item("\163\141\x6c\x74\x5f\x6c\x65\156\x67\164\150", "\151\157\156\x5f\x61\165\x74\150"); goto femuZ; zlro1: $salt_db = $query->row(); goto SQ2Of; th4ma: $result = $this->_set_password_db($identity, $password); goto fRmMi; sIQMl: } }
